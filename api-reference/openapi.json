{"openapi":"3.0.0","paths":{"/api/v1/bean/accounts":{"post":{"operationId":"AccountController_create","summary":"Create a new account","description":"Creates a new account (Beancount Open directive)","parameters":[],"requestBody":{"required":true,"content":{"application/json":{"schema":{"$ref":"#/components/schemas/CreateAccountDto"}}}},"responses":{"201":{"description":"Account created successfully","content":{"application/json":{"schema":{"$ref":"#/components/schemas/AccountResponseDto"}}}},"409":{"description":"Account already exists"}},"tags":["Bean Accounts"],"security":[{"bearer":[]}]},"get":{"operationId":"AccountController_findAll","summary":"List accounts","description":"Returns all accounts with optional filtering","parameters":[{"name":"type","required":false,"in":"query","description":"Filter by account type","schema":{"enum":["Assets","Liabilities","Income","Expenses","Equity"],"type":"string"}},{"name":"status","required":false,"in":"query","description":"Filter by status","schema":{"default":"OPEN","enum":["OPEN","CLOSED","SUSPENDED"],"type":"string"}},{"name":"isCustom","required":false,"in":"query","description":"Filter by custom (user-created) accounts only","schema":{"type":"boolean"}},{"name":"search","required":false,"in":"query","description":"Search term for path or i18nKey","schema":{"type":"string"}},{"name":"limit","required":false,"in":"query","description":"Maximum number of results","schema":{"minimum":1,"maximum":500,"default":100,"type":"number"}},{"name":"offset","required":false,"in":"query","description":"Number of results to skip","schema":{"minimum":0,"default":0,"type":"number"}}],"responses":{"200":{"description":"Accounts retrieved successfully","content":{"application/json":{"schema":{"$ref":"#/components/schemas/AccountListResponseDto"}}}}},"tags":["Bean Accounts"],"security":[{"bearer":[]}]}},"/api/v1/bean/accounts/{id}":{"get":{"operationId":"AccountController_findOne","summary":"Get account by ID","description":"Returns a specific account","parameters":[{"name":"id","required":true,"in":"path","description":"Account UUID","schema":{"example":"550e8400-e29b-41d4-a716-446655440000","type":"string"}}],"responses":{"200":{"description":"Account retrieved successfully","content":{"application/json":{"schema":{"$ref":"#/components/schemas/AccountResponseDto"}}}},"404":{"description":"Account not found"}},"tags":["Bean Accounts"],"security":[{"bearer":[]}]},"put":{"operationId":"AccountController_update","summary":"Update account","description":"Updates account metadata (path cannot be changed)","parameters":[{"name":"id","required":true,"in":"path","description":"Account UUID","schema":{"type":"string"}}],"requestBody":{"required":true,"content":{"application/json":{"schema":{"$ref":"#/components/schemas/UpdateAccountDto"}}}},"responses":{"200":{"description":"Account updated successfully","content":{"application/json":{"schema":{"$ref":"#/components/schemas/AccountResponseDto"}}}},"404":{"description":"Account not found"}},"tags":["Bean Accounts"],"security":[{"bearer":[]}]},"delete":{"operationId":"AccountController_delete","summary":"Delete account","description":"Deletes an account (only if no transactions)","parameters":[{"name":"id","required":true,"in":"path","description":"Account UUID","schema":{"type":"string"}}],"responses":{"204":{"description":"Account deleted successfully"},"404":{"description":"Account not found"},"409":{"description":"Account has transactions and cannot be deleted"}},"tags":["Bean Accounts"],"security":[{"bearer":[]}]}},"/api/v1/bean/accounts/{id}/close":{"post":{"operationId":"AccountController_close","summary":"Close account","description":"Closes an account (Beancount Close directive)","parameters":[{"name":"id","required":true,"in":"path","description":"Account UUID","schema":{"type":"string"}}],"requestBody":{"required":true,"content":{"application/json":{"schema":{"$ref":"#/components/schemas/CloseAccountDto"}}}},"responses":{"200":{"description":"Account closed successfully","content":{"application/json":{"schema":{"$ref":"#/components/schemas/AccountResponseDto"}}}},"400":{"description":"Account is already closed"},"404":{"description":"Account not found"}},"tags":["Bean Accounts"],"security":[{"bearer":[]}]}},"/api/v1/bean/accounts/{id}/reopen":{"post":{"operationId":"AccountController_reopen","summary":"Reopen account","description":"Reopens a previously closed account","parameters":[{"name":"id","required":true,"in":"path","description":"Account UUID","schema":{"type":"string"}}],"requestBody":{"required":true,"content":{"application/json":{"schema":{"$ref":"#/components/schemas/ReopenAccountDto"}}}},"responses":{"200":{"description":"Account reopened successfully","content":{"application/json":{"schema":{"$ref":"#/components/schemas/AccountResponseDto"}}}},"400":{"description":"Account is not closed"},"404":{"description":"Account not found"}},"tags":["Bean Accounts"],"security":[{"bearer":[]}]}},"/api/v1/bean/transactions":{"post":{"operationId":"TransactionController_create","summary":"Create transaction","description":"Creates a new double-entry transaction. User must provide valid account names.","parameters":[],"requestBody":{"required":true,"description":"Transaction data with postings","content":{"application/json":{"schema":{"$ref":"#/components/schemas/CreateTransactionDto"}}}},"responses":{"201":{"description":"Transaction created successfully","content":{"application/json":{"schema":{"$ref":"#/components/schemas/TransactionResponseDto"}}}},"400":{"description":"Validation failed","content":{"application/json":{"schema":{"$ref":"#/components/schemas/ApiProblemResponseDto"}}}},"401":{"description":"Authentication required","content":{"application/json":{"schema":{"$ref":"#/components/schemas/ApiProblemResponseDto"}}}},"422":{"description":"Semantic validation failed (transaction does not balance, invalid accounts)","content":{"application/json":{"schema":{"$ref":"#/components/schemas/ApiProblemResponseDto"}}}},"500":{"description":"Unexpected server error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/ApiProblemResponseDto"}}}}},"tags":["Bean Transactions"],"security":[{"bearer":[]}]},"get":{"operationId":"TransactionController_list","summary":"List transactions","description":"Returns a paginated list of transactions with optional filters","parameters":[{"name":"limit","required":false,"in":"query","description":"Number of items per page (1-100, default: 20)","schema":{"minimum":1,"maximum":100,"default":20,"example":20,"type":"number"}},{"name":"offset","required":false,"in":"query","description":"Number of items to skip (default: 0)","schema":{"minimum":0,"default":0,"example":0,"type":"number"}},{"name":"dateFrom","required":false,"in":"query","description":"Filter by start date (inclusive), format: YYYY-MM-DD","schema":{"example":"2024-01-01","type":"string"}},{"name":"dateTo","required":false,"in":"query","description":"Filter by end date (inclusive), format: YYYY-MM-DD","schema":{"example":"2024-12-31","type":"string"}},{"name":"status","required":false,"in":"query","description":"Filter by transaction status","schema":{"enum":["ACTIVE","VOIDED","SUPERSEDED"],"type":"string"}},{"name":"search","required":false,"in":"query","description":"Search in narration and payee fields (max 200 chars)","schema":{"maxLength":200,"example":"grocery","type":"string"}},{"name":"accountId","required":false,"in":"query","description":"Filter by account ID (transactions with postings to this account)","schema":{"example":"clh1234567890abcdef","type":"string"}}],"responses":{"200":{"description":"Transaction list","content":{"application/json":{"schema":{"$ref":"#/components/schemas/TransactionListResponseDto"}}}},"401":{"description":"Authentication required","content":{"application/json":{"schema":{"$ref":"#/components/schemas/ApiProblemResponseDto"}}}}},"tags":["Bean Transactions"],"security":[{"bearer":[]}]}},"/api/v1/bean/transactions/{id}":{"get":{"operationId":"TransactionController_getDetail","summary":"Get transaction detail","description":"Returns transaction details including all postings","parameters":[{"name":"id","required":true,"in":"path","description":"Transaction ID","schema":{"type":"string"}}],"responses":{"200":{"description":"Transaction detail","content":{"application/json":{"schema":{"$ref":"#/components/schemas/TransactionDetailDto"}}}},"401":{"description":"Authentication required","content":{"application/json":{"schema":{"$ref":"#/components/schemas/ApiProblemResponseDto"}}}},"404":{"description":"Transaction not found","content":{"application/json":{"schema":{"$ref":"#/components/schemas/ApiProblemResponseDto"}}}}},"tags":["Bean Transactions"],"security":[{"bearer":[]}]},"patch":{"operationId":"TransactionController_update","summary":"Update transaction metadata","description":"Updates transaction metadata (flag, payee, narration, tags, links, meta). Postings cannot be modified.","parameters":[{"name":"id","required":true,"in":"path","description":"Transaction ID","schema":{"type":"string"}}],"requestBody":{"required":true,"description":"Fields to update (all optional)","content":{"application/json":{"schema":{"$ref":"#/components/schemas/UpdateTransactionDto"}}}},"responses":{"200":{"description":"Transaction updated successfully","content":{"application/json":{"schema":{"$ref":"#/components/schemas/TransactionDetailDto"}}}},"400":{"description":"Cannot update voided transaction","content":{"application/json":{"schema":{"$ref":"#/components/schemas/ApiProblemResponseDto"}}}},"401":{"description":"Authentication required","content":{"application/json":{"schema":{"$ref":"#/components/schemas/ApiProblemResponseDto"}}}},"404":{"description":"Transaction not found","content":{"application/json":{"schema":{"$ref":"#/components/schemas/ApiProblemResponseDto"}}}}},"tags":["Bean Transactions"],"security":[{"bearer":[]}]},"delete":{"operationId":"TransactionController_","parameters":[],"responses":{"204":{"description":""}},"tags":["Bean Transactions"],"security":[{"bearer":[]}]}},"/api/v1/bean/account-standards":{"get":{"operationId":"AccountStandardsController_getTemplates","summary":"Get account templates","description":"Returns predefined account templates for a region. Supports filtering by account type and search term.","parameters":[{"name":"region","required":false,"in":"query","description":"Region code (e.g., CN, US, universal)","schema":{"default":"universal","example":"CN","type":"string"}},{"name":"type","required":false,"in":"query","description":"Filter by account type","schema":{"example":"Assets","enum":["Assets","Liabilities","Income","Expenses","Equity"],"type":"string"}},{"name":"search","required":false,"in":"query","description":"Search term for path or description","schema":{"example":"Bank","type":"string"}}],"responses":{"200":{"description":"Account templates retrieved successfully","content":{"application/json":{"schema":{"$ref":"#/components/schemas/AccountStandardListResponseDto"}}}}},"tags":["Bean Account Standards"]}},"/api/v1/bean/account-standards/regions":{"get":{"operationId":"AccountStandardsController_getRegions","summary":"Get available regions","description":"Returns list of supported region codes","parameters":[],"responses":{"200":{"description":"Regions retrieved successfully","content":{"application/json":{"schema":{"type":"object","properties":{"regions":{"type":"array","items":{"type":"string"},"example":["universal","cn","us"]}}}}}}},"tags":["Bean Account Standards"]}},"/api/v1/bean/balances":{"get":{"operationId":"BalanceController_getBalance","summary":"Query account balance","description":"Calculate account balance at a specific date for a single currency","parameters":[{"name":"account","required":true,"in":"query","description":"Account name (e.g., \"Assets:Bank:Checking\")","schema":{"example":"Assets:Bank:Checking","type":"string"}},{"name":"date","required":false,"in":"query","description":"Date to calculate balance at (ISO 8601 format)","schema":{"example":"2024-12-31","type":"string"}},{"name":"currency","required":false,"in":"query","description":"Currency to query (e.g., \"USD\", \"CNY\")","schema":{"example":"USD","type":"string"}}],"responses":{"200":{"description":"Balance calculated successfully","content":{"application/json":{"schema":{"$ref":"#/components/schemas/BalanceResponseDto"}}}},"400":{"description":"Invalid query parameters"},"401":{"description":"User not authenticated"}},"tags":["Bean - Balances"],"security":[{"bearer":[]}]}},"/api/v1/bean/balances/multi-currency":{"get":{"operationId":"BalanceController_getMultiCurrencyBalance","summary":"Query multi-currency account balance","description":"Calculate account balances for all currencies at a specific date","parameters":[],"responses":{"200":{"description":"Balances calculated successfully","content":{"application/json":{"schema":{"$ref":"#/components/schemas/MultiCurrencyBalanceResponseDto"}}}},"400":{"description":"Invalid query parameters"},"401":{"description":"User not authenticated"}},"tags":["Bean - Balances"],"security":[{"bearer":[]}]}},"/api/v1/bean/reviews":{"get":{"operationId":"ReviewController_findAll","summary":"List pending reviews","parameters":[{"name":"type","required":false,"in":"query","description":"Filter by review type","schema":{"enum":["DUPLICATE","RULE_MATCH","PAYEE_MATCH","ACCOUNT_VALIDATION","PIPELINE_ERROR"],"type":"string"}},{"name":"confidenceLevel","required":false,"in":"query","description":"Filter by confidence level","schema":{"enum":["all","high","medium","low"],"type":"string"}},{"name":"sortBy","required":false,"in":"query","description":"Sort order","schema":{"enum":["time","confidence","type"],"type":"string"}},{"name":"page","required":false,"in":"query","description":"Page number (default: 1)","schema":{"minimum":1,"default":1,"type":"number"}},{"name":"limit","required":false,"in":"query","description":"Items per page (1-100, default: 20)","schema":{"minimum":1,"maximum":100,"default":20,"type":"number"}}],"responses":{"200":{"description":"","content":{"application/json":{"schema":{"$ref":"#/components/schemas/ReviewListResponseDto"}}}},"400":{"description":"","content":{"application/json":{"schema":{"$ref":"#/components/schemas/ApiProblemResponseDto"}}}}},"tags":["Bean Reviews"],"security":[{"bearer":[]}]}},"/api/v1/bean/reviews/stats":{"get":{"operationId":"ReviewController_getStats","summary":"Get review statistics","parameters":[],"responses":{"200":{"description":"","content":{"application/json":{"schema":{"$ref":"#/components/schemas/ReviewStatsDto"}}}},"400":{"description":"","content":{"application/json":{"schema":{"$ref":"#/components/schemas/ApiProblemResponseDto"}}}}},"tags":["Bean Reviews"],"security":[{"bearer":[]}]}},"/api/v1/bean/reviews/{id}":{"get":{"operationId":"ReviewController_findOne","summary":"Get review by ID","parameters":[{"name":"id","required":true,"in":"path","description":"Review ID","schema":{"type":"string"}}],"responses":{"200":{"description":"","content":{"application/json":{"schema":{"$ref":"#/components/schemas/ReviewDetailDto"}}}},"404":{"description":"","content":{"application/json":{"schema":{"$ref":"#/components/schemas/ApiProblemResponseDto"}}}}},"tags":["Bean Reviews"],"security":[{"bearer":[]}]}},"/api/v1/bean/reviews/{id}/resolve":{"post":{"operationId":"ReviewController_","parameters":[],"responses":{"201":{"description":""}},"tags":["Bean Reviews"],"security":[{"bearer":[]}]}},"/api/v1/bean/reviews/{id}/undo":{"post":{"operationId":"ReviewController_","parameters":[],"responses":{"201":{"description":""}},"tags":["Bean Reviews"],"security":[{"bearer":[]}]}},"/api/v1/bean/reviews/batch-resolve":{"post":{"operationId":"ReviewController_","parameters":[],"responses":{"201":{"description":""}},"tags":["Bean Reviews"],"security":[{"bearer":[]}]}},"/api/v1/bean/payees":{"post":{"operationId":"PayeeController_","parameters":[],"responses":{"201":{"description":""}},"tags":["Bean Payees"],"security":[{"bearer":[]}]},"get":{"operationId":"PayeeController_findAll","summary":"List user payees","description":"Returns all payee mappings for the authenticated user with optional filtering","parameters":[{"name":"search","required":false,"in":"query","description":"Search term for payee name (partial match, case-insensitive). Useful for autocomplete.","schema":{"example":"Star","type":"string"}},{"name":"payee","required":false,"in":"query","description":"Filter by exact payee name match","schema":{"example":"Starbucks","type":"string"}},{"name":"category","required":false,"in":"query","description":"Filter by custom category","schema":{"example":"Dining:Coffee","type":"string"}},{"name":"tag","required":false,"in":"query","description":"Filter by custom tag (returns payees that have this tag)","schema":{"example":"favorite","type":"string"}},{"name":"isActive","required":false,"in":"query","description":"Filter by active status. Defaults to true (show only active payees).","schema":{"default":true,"example":true,"type":"boolean"}}],"responses":{"200":{"description":"Payees retrieved successfully","content":{"application/json":{"schema":{"$ref":"#/components/schemas/PayeeListResponseDto"}}}}},"tags":["Bean Payees"],"security":[{"bearer":[]}]}},"/api/v1/bean/payees/autocomplete":{"get":{"operationId":"PayeeController_autocomplete","summary":"Get payee autocomplete suggestions","description":"Returns active payee names matching the query, sorted by recent usage. Used for transaction input autocomplete.","parameters":[{"name":"q","required":true,"in":"query","description":"Search query for payee name (partial match, case-insensitive)","schema":{"example":"Star","type":"string"}},{"name":"limit","required":false,"in":"query","description":"Maximum number of suggestions","schema":{"example":10,"type":"number"}}],"responses":{"200":{"description":"Autocomplete suggestions retrieved successfully","content":{"application/json":{"schema":{"$ref":"#/components/schemas/PayeeAutocompleteResponseDto"}}}}},"tags":["Bean Payees"],"security":[{"bearer":[]}]}},"/api/v1/bean/payees/top":{"get":{"operationId":"PayeeController_getTopPayees","summary":"Get top payees by usage","description":"Returns the most frequently used payees, sorted by use count. Used for statistics and analytics.","parameters":[{"name":"limit","required":false,"in":"query","description":"Maximum number of results","schema":{"example":10,"type":"number"}}],"responses":{"200":{"description":"Top payees retrieved successfully","content":{"application/json":{"schema":{"type":"array","items":{"$ref":"#/components/schemas/PayeeStatsResponseDto"}}}}}},"tags":["Bean Payees"],"security":[{"bearer":[]}]}},"/api/v1/bean/payees/{id}":{"get":{"operationId":"PayeeController_findOne","summary":"Get payee by ID","description":"Returns a specific payee mapping by its UUID","parameters":[{"name":"id","required":true,"in":"path","description":"Payee UUID","schema":{"example":"uuid-123-456","type":"string"}}],"responses":{"200":{"description":"Payee retrieved successfully","content":{"application/json":{"schema":{"$ref":"#/components/schemas/PayeeResponseDto"}}}},"403":{"description":"Payee belongs to another user","content":{"application/json":{"schema":{"$ref":"#/components/schemas/ApiProblemResponseDto"}}}},"404":{"description":"Payee not found","content":{"application/json":{"schema":{"$ref":"#/components/schemas/ApiProblemResponseDto"}}}}},"tags":["Bean Payees"],"security":[{"bearer":[]}]},"put":{"operationId":"PayeeController_","parameters":[],"responses":{"200":{"description":""}},"tags":["Bean Payees"],"security":[{"bearer":[]}]},"delete":{"operationId":"PayeeController_","parameters":[],"responses":{"204":{"description":""}},"tags":["Bean Payees"],"security":[{"bearer":[]}]}},"/api/v1/admin/payee-profiles":{"post":{"operationId":"PayeeProfileAdminController_","parameters":[],"responses":{"201":{"description":""}},"tags":["Admin - Payee Profiles"],"security":[{"bearer":[]}]},"get":{"operationId":"PayeeProfileAdminController_findAll","summary":"List payee profiles (Admin only)","description":"Returns all payee profiles with optional filtering by category, country, verification status, etc.","parameters":[{"name":"search","required":false,"in":"query","description":"Search term for canonical name and aliases (case-insensitive)","schema":{"example":"starbucks","type":"string"}},{"name":"category","required":false,"in":"query","description":"Filter by category","schema":{"example":"CAFE","enum":["RESTAURANT","CAFE","FAST_FOOD","BAR","SUPERMARKET","CONVENIENCE_STORE","SHOPPING_MALL","ONLINE_SHOPPING","TAXI","RIDE_SHARING","PUBLIC_TRANSPORT","PARKING","GAS_STATION","UTILITIES","TELECOM","STREAMING","HEALTHCARE","EDUCATION","ENTERTAINMENT","SPORTS","TRAVEL","HOTEL","OTHER"],"type":"string"}},{"name":"country","required":false,"in":"query","description":"Filter by country (ISO 3166-1 alpha-2)","schema":{"example":"US","type":"string"}},{"name":"isActive","required":false,"in":"query","description":"Filter by active status (default: true - show only active)","schema":{"example":true,"type":"boolean"}},{"name":"verified","required":false,"in":"query","description":"Filter by verification status. true = verified only, false = unverified only","schema":{"example":true,"type":"boolean"}},{"name":"dataSource","required":false,"in":"query","description":"Filter by data source","schema":{"example":"MANUAL","enum":["MANUAL","IMPORT","API","CROWDSOURCED"],"type":"string"}}],"responses":{"200":{"description":"Payee profiles retrieved successfully","content":{"application/json":{"schema":{"$ref":"#/components/schemas/PayeeProfileListResponseDto"}}}},"403":{"description":"Admin access required","content":{"application/json":{"schema":{"$ref":"#/components/schemas/ApiProblemResponseDto"}}}}},"tags":["Admin - Payee Profiles"],"security":[{"bearer":[]}]}},"/api/v1/admin/payee-profiles/{id}":{"get":{"operationId":"PayeeProfileAdminController_findOne","summary":"Get payee profile by ID (Admin only)","description":"Returns a single payee profile by its ID.","parameters":[{"name":"id","required":true,"in":"path","description":"Payee profile ID (UUID)","schema":{"example":"550e8400-e29b-41d4-a716-446655440000","type":"string"}}],"responses":{"200":{"description":"Payee profile retrieved successfully","content":{"application/json":{"schema":{"$ref":"#/components/schemas/PayeeProfileResponseDto"}}}},"403":{"description":"Admin access required","content":{"application/json":{"schema":{"$ref":"#/components/schemas/ApiProblemResponseDto"}}}},"404":{"description":"Payee profile not found","content":{"application/json":{"schema":{"$ref":"#/components/schemas/ApiProblemResponseDto"}}}}},"tags":["Admin - Payee Profiles"],"security":[{"bearer":[]}]},"put":{"operationId":"PayeeProfileAdminController_","parameters":[],"responses":{"200":{"description":""}},"tags":["Admin - Payee Profiles"],"security":[{"bearer":[]}]},"delete":{"operationId":"PayeeProfileAdminController_","parameters":[],"responses":{"204":{"description":""}},"tags":["Admin - Payee Profiles"],"security":[{"bearer":[]}]}},"/api/v1/admin/payee-profiles/{id}/verify":{"post":{"operationId":"PayeeProfileAdminController_","parameters":[],"responses":{"201":{"description":""}},"tags":["Admin - Payee Profiles"],"security":[{"bearer":[]}]},"delete":{"operationId":"PayeeProfileAdminController_","parameters":[],"responses":{"200":{"description":""}},"tags":["Admin - Payee Profiles"],"security":[{"bearer":[]}]}},"/api/v1/bean/commodities":{"post":{"operationId":"CommodityController_","parameters":[],"responses":{"201":{"description":""}},"tags":["Bean Commodities"],"security":[{"bearer":[]}]},"get":{"operationId":"CommodityController_findAll","summary":"List user commodities","description":"Returns all commodity definitions for the authenticated user with optional filtering","parameters":[{"name":"search","required":false,"in":"query","description":"Search term for symbol or metadata fields (partial match). Searches symbol and metadata.name.","schema":{"example":"AAP","type":"string"}},{"name":"symbol","required":false,"in":"query","description":"Filter by exact symbol match","schema":{"example":"AAPL","type":"string"}}],"responses":{"200":{"description":"Commodities retrieved successfully","content":{"application/json":{"schema":{"$ref":"#/components/schemas/CommodityListResponseDto"}}}}},"tags":["Bean Commodities"],"security":[{"bearer":[]}]}},"/api/v1/bean/commodities/{symbol}":{"get":{"operationId":"CommodityController_findOne","summary":"Get commodity by symbol","description":"Returns a specific commodity definition by its symbol","parameters":[{"name":"symbol","required":true,"in":"path","description":"Commodity symbol","schema":{"example":"AAPL","type":"string"}}],"responses":{"200":{"description":"Commodity retrieved successfully","content":{"application/json":{"schema":{"$ref":"#/components/schemas/CommodityResponseDto"}}}},"404":{"description":"Commodity not found","content":{"application/json":{"schema":{"$ref":"#/components/schemas/ApiProblemResponseDto"}}}}},"tags":["Bean Commodities"],"security":[{"bearer":[]}]},"put":{"operationId":"CommodityController_","parameters":[],"responses":{"200":{"description":""}},"tags":["Bean Commodities"],"security":[{"bearer":[]}]},"delete":{"operationId":"CommodityController_","parameters":[],"responses":{"204":{"description":""}},"tags":["Bean Commodities"],"security":[{"bearer":[]}]}},"/api/v1/bean/commodities/{symbol}/ensure":{"post":{"operationId":"CommodityController_","parameters":[],"responses":{"201":{"description":""}},"tags":["Bean Commodities"],"security":[{"bearer":[]}]}},"/api/v1/bean/commodities/bulk":{"post":{"operationId":"CommodityController_","parameters":[],"responses":{"201":{"description":""}},"tags":["Bean Commodities"],"security":[{"bearer":[]}]}},"/api/v1/bean/recurring-rules":{"post":{"operationId":"RecurringRuleController_","parameters":[],"responses":{"201":{"description":""}},"tags":["Recurring Rules"],"security":[{"bearer":[]}]},"get":{"operationId":"RecurringRuleController_findAll","summary":"List recurring rules","description":"Returns all recurring rules for the authenticated user with optional filtering","parameters":[{"name":"isActive","required":false,"in":"query","description":"Filter by active status","schema":{"type":"boolean"}},{"name":"frequency","required":false,"in":"query","description":"Filter by frequency (WEEKLY, MONTHLY, etc.)","schema":{"type":"string"}},{"name":"hasAutoCreate","required":false,"in":"query","description":"Filter by autoCreate enabled","schema":{"type":"boolean"}}],"responses":{"200":{"description":"Rules retrieved successfully","content":{"application/json":{"schema":{"type":"array","items":{"$ref":"#/components/schemas/RecurringRuleResponseDto"}}}}}},"tags":["Recurring Rules"],"security":[{"bearer":[]}]}},"/api/v1/bean/recurring-rules/from-transaction/{transactionId}":{"post":{"operationId":"RecurringRuleController_","parameters":[],"responses":{"201":{"description":""}},"tags":["Recurring Rules"],"security":[{"bearer":[]}]}},"/api/v1/bean/recurring-rules/{id}":{"get":{"operationId":"RecurringRuleController_findOne","summary":"Get recurring rule by ID","description":"Returns a specific recurring rule with its details","parameters":[{"name":"id","required":true,"in":"path","description":"Rule ID","schema":{"type":"string"}}],"responses":{"200":{"description":"Rule retrieved successfully","content":{"application/json":{"schema":{"$ref":"#/components/schemas/RecurringRuleResponseDto"}}}},"404":{"description":"Rule not found"}},"tags":["Recurring Rules"],"security":[{"bearer":[]}]},"patch":{"operationId":"RecurringRuleController_","parameters":[],"responses":{"200":{"description":""}},"tags":["Recurring Rules"],"security":[{"bearer":[]}]},"delete":{"operationId":"RecurringRuleController_","parameters":[],"responses":{"204":{"description":""}},"tags":["Recurring Rules"],"security":[{"bearer":[]}]}},"/api/v1/bean/recurring-rules/{id}/stats":{"get":{"operationId":"RecurringRuleController_getWithStats","summary":"Get rule with statistics","description":"Returns a rule with pending/overdue counts and next expected date","parameters":[{"name":"id","required":true,"in":"path","description":"Rule ID","schema":{"type":"string"}}],"responses":{"200":{"description":"Rule with stats retrieved successfully","content":{"application/json":{"schema":{"$ref":"#/components/schemas/RecurringRuleWithStatsResponseDto"}}}},"404":{"description":"Rule not found"}},"tags":["Recurring Rules"],"security":[{"bearer":[]}]}},"/api/v1/bean/expected-transactions":{"get":{"operationId":"ExpectedTransactionController_findAll","summary":"List expected transactions","description":"Returns expected transactions for the authenticated user with optional filtering","parameters":[{"name":"ruleId","required":false,"in":"query","description":"Filter by recurring rule ID","schema":{"type":"string"}},{"name":"status","required":false,"in":"query","description":"Filter by status (PENDING, COMPLETED, SKIPPED)","schema":{"type":"string"}},{"name":"fromDate","required":false,"in":"query","description":"Filter by date range start (YYYY-MM-DD)","schema":{"type":"string"}},{"name":"toDate","required":false,"in":"query","description":"Filter by date range end (YYYY-MM-DD)","schema":{"type":"string"}}],"responses":{"200":{"description":"Expected transactions retrieved successfully","content":{"application/json":{"schema":{"$ref":"#/components/schemas/ExpectedTransactionListResponseDto"}}}}},"tags":["Expected Transactions"],"security":[{"bearer":[]}]}},"/api/v1/bean/expected-transactions/overdue":{"get":{"operationId":"ExpectedTransactionController_findOverdue","summary":"List overdue expected transactions","description":"Returns all overdue expected transactions (PENDING past tolerance)","parameters":[],"responses":{"200":{"description":"Overdue transactions retrieved successfully","content":{"application/json":{"schema":{"$ref":"#/components/schemas/ExpectedTransactionListResponseDto"}}}}},"tags":["Expected Transactions"],"security":[{"bearer":[]}]}},"/api/v1/bean/expected-transactions/{id}":{"get":{"operationId":"ExpectedTransactionController_findOne","summary":"Get expected transaction by ID","description":"Returns a specific expected transaction with rule details","parameters":[{"name":"id","required":true,"in":"path","description":"Expected transaction ID","schema":{"type":"string"}}],"responses":{"200":{"description":"Expected transaction retrieved successfully","content":{"application/json":{"schema":{"$ref":"#/components/schemas/ExpectedTransactionResponseDto"}}}},"404":{"description":"Expected transaction not found"}},"tags":["Expected Transactions"],"security":[{"bearer":[]}]}},"/api/v1/bean/expected-transactions/{id}/skip":{"post":{"operationId":"ExpectedTransactionController_","parameters":[],"responses":{"200":{"description":""}},"tags":["Expected Transactions"],"security":[{"bearer":[]}]},"delete":{"operationId":"ExpectedTransactionController_","parameters":[],"responses":{"200":{"description":""}},"tags":["Expected Transactions"],"security":[{"bearer":[]}]}},"/api/v1/bean/expected-transactions/{id}/match":{"post":{"operationId":"ExpectedTransactionController_","parameters":[],"responses":{"200":{"description":""}},"tags":["Expected Transactions"],"security":[{"bearer":[]}]},"delete":{"operationId":"ExpectedTransactionController_","parameters":[],"responses":{"200":{"description":""}},"tags":["Expected Transactions"],"security":[{"bearer":[]}]}},"/api/v1/bean/expected-transactions/{id}/enter":{"post":{"operationId":"ExpectedTransactionController_","parameters":[],"responses":{"201":{"description":""}},"tags":["Expected Transactions"],"security":[{"bearer":[]}]}},"/api/v1/bean/recurring/forecast":{"get":{"operationId":"ForecastController_getForecast","summary":"Get cash flow forecast","description":"Returns predicted outflows for the next N months based on active recurring rules","parameters":[{"name":"months","required":false,"in":"query","description":"Number of months to forecast (1-12, default 3)","schema":{"minimum":1,"maximum":12,"example":3,"type":"number"}}],"responses":{"200":{"description":"Forecast retrieved successfully","content":{"application/json":{"schema":{"$ref":"#/components/schemas/ForecastResponseDto"}}}}},"tags":["Recurring Forecast"],"security":[{"bearer":[]}]}},"/api/v1/bean/transaction-rules":{"post":{"operationId":"TransactionRuleController_","parameters":[],"responses":{"201":{"description":""}},"tags":["Bean Transaction Rules"],"security":[{"bearer":[]}]},"get":{"operationId":"TransactionRuleController_list","summary":"Get all transaction rules for user","parameters":[{"name":"limit","required":false,"in":"query","description":"Max results per page (default: 20, max: 100)","schema":{"type":"number"}},{"name":"offset","required":false,"in":"query","description":"Pagination offset (default: 0)","schema":{"type":"number"}},{"name":"enabled","required":false,"in":"query","description":"Filter by enabled status","schema":{"type":"boolean"}},{"name":"learningSource","required":false,"in":"query","description":"Filter by learning source. Omit this parameter or pass empty string to get manually created rules (learningSource is null in database).","schema":{"enum":["NLP","REVIEW_CENTER"],"type":"string"}},{"name":"autoApplyEnabled","required":false,"in":"query","description":"Filter by auto-apply status","schema":{"type":"boolean"}}],"responses":{"200":{"description":"List of rules","content":{"application/json":{"schema":{"$ref":"#/components/schemas/TransactionRuleListResponseDto"}}}},"401":{"description":"Unauthorized","content":{"application/json":{"schema":{"$ref":"#/components/schemas/ApiProblemResponseDto"}}}}},"tags":["Bean Transaction Rules"],"security":[{"bearer":[]}]}},"/api/v1/bean/transaction-rules/validate":{"post":{"operationId":"TransactionRuleController_validate","summary":"Validate transaction rule configuration","parameters":[],"requestBody":{"required":true,"content":{"application/json":{"schema":{"$ref":"#/components/schemas/ValidateRuleDto"}}}},"responses":{"200":{"description":"Validation result","content":{"application/json":{"schema":{"$ref":"#/components/schemas/ValidateRuleResponseDto"}}}},"401":{"description":"Unauthorized","content":{"application/json":{"schema":{"$ref":"#/components/schemas/ApiProblemResponseDto"}}}}},"tags":["Bean Transaction Rules"],"security":[{"bearer":[]}]}},"/api/v1/bean/transaction-rules/bulk":{"post":{"operationId":"TransactionRuleController_","parameters":[],"responses":{"201":{"description":""}},"tags":["Bean Transaction Rules"],"security":[{"bearer":[]}]}},"/api/v1/bean/transaction-rules/export/{format}":{"get":{"operationId":"TransactionRuleController_export","summary":"Export transaction rules","parameters":[{"name":"format","required":true,"in":"path","description":"Export format (currently only JSON supported)","schema":{"enum":["json"],"type":"string"}}],"responses":{"200":{"description":"Exported rules","content":{"application/json":{"schema":{"$ref":"#/components/schemas/ExportRulesResponseDto"}}}},"400":{"description":"Unsupported format","content":{"application/json":{"schema":{"$ref":"#/components/schemas/ApiProblemResponseDto"}}}},"401":{"description":"Unauthorized","content":{"application/json":{"schema":{"$ref":"#/components/schemas/ApiProblemResponseDto"}}}}},"tags":["Bean Transaction Rules"],"security":[{"bearer":[]}]}},"/api/v1/bean/transaction-rules/statistics/{period}":{"get":{"operationId":"TransactionRuleController_getStatistics","summary":"Get transaction rule statistics","parameters":[{"name":"period","required":true,"in":"path","description":"Statistics time period","schema":{"enum":["7d","30d","90d"],"type":"string"}}],"responses":{"200":{"description":"Rule statistics","content":{"application/json":{"schema":{"$ref":"#/components/schemas/RuleStatisticsResponseDto"}}}},"401":{"description":"Unauthorized","content":{"application/json":{"schema":{"$ref":"#/components/schemas/ApiProblemResponseDto"}}}}},"tags":["Bean Transaction Rules"],"security":[{"bearer":[]}]}},"/api/v1/bean/transaction-rules/{ruleId}":{"get":{"operationId":"TransactionRuleController_getDetail","summary":"Get transaction rule detail","parameters":[{"name":"ruleId","required":true,"in":"path","description":"Rule ID","schema":{"type":"string"}}],"responses":{"200":{"description":"Rule details","content":{"application/json":{"schema":{"$ref":"#/components/schemas/TransactionRuleResponseDto"}}}},"401":{"description":"Unauthorized","content":{"application/json":{"schema":{"$ref":"#/components/schemas/ApiProblemResponseDto"}}}},"403":{"description":"Forbidden - not owner of rule","content":{"application/json":{"schema":{"$ref":"#/components/schemas/ApiProblemResponseDto"}}}},"404":{"description":"Rule not found","content":{"application/json":{"schema":{"$ref":"#/components/schemas/ApiProblemResponseDto"}}}}},"tags":["Bean Transaction Rules"],"security":[{"bearer":[]}]},"put":{"operationId":"TransactionRuleController_","parameters":[],"responses":{"200":{"description":""}},"tags":["Bean Transaction Rules"],"security":[{"bearer":[]}]},"delete":{"operationId":"TransactionRuleController_","parameters":[],"responses":{"204":{"description":""}},"tags":["Bean Transaction Rules"],"security":[{"bearer":[]}]}},"/api/v1/bean/transaction-rules/{ruleId}/test":{"post":{"operationId":"TransactionRuleController_test","summary":"Test rule matching","parameters":[{"name":"ruleId","required":true,"in":"path","description":"Rule ID to test","schema":{"type":"string"}}],"requestBody":{"required":true,"content":{"application/json":{"schema":{"$ref":"#/components/schemas/TestRuleDto"}}}},"responses":{"200":{"description":"Test result","content":{"application/json":{"schema":{"$ref":"#/components/schemas/TestRuleResponseDto"}}}},"401":{"description":"Unauthorized","content":{"application/json":{"schema":{"$ref":"#/components/schemas/ApiProblemResponseDto"}}}},"403":{"description":"Forbidden - not owner of rule","content":{"application/json":{"schema":{"$ref":"#/components/schemas/ApiProblemResponseDto"}}}},"404":{"description":"Rule not found","content":{"application/json":{"schema":{"$ref":"#/components/schemas/ApiProblemResponseDto"}}}}},"tags":["Bean Transaction Rules"],"security":[{"bearer":[]}]}},"/api/v1/users":{"delete":{"operationId":"UserController_deleteOwnUser","summary":"Delete own user account","parameters":[],"requestBody":{"required":true,"content":{"application/json":{"schema":{"$ref":"#/components/schemas/DeleteOwnUserDto"}}}},"responses":{"204":{"description":"User deleted successfully"},"403":{"description":"Invalid access token"}},"tags":["Users"],"security":[{"bearer":[]}]},"get":{"operationId":"UserController_getUser","summary":"Get current authenticated user","parameters":[{"name":"accept-language","required":true,"in":"header","schema":{"type":"string"}}],"responses":{"200":{"description":"User retrieved successfully"}},"tags":["Users"],"security":[{"bearer":[]}]},"post":{"operationId":"UserController_signupUser","summary":"Sign up new user","parameters":[],"responses":{"201":{"description":"User created successfully"},"403":{"description":"User signup is disabled"}},"tags":["Users"],"security":[{"bearer":[]}]}},"/api/v1/users/{id}":{"delete":{"operationId":"UserController_deleteUser","summary":"Delete user by ID (admin only)","parameters":[{"name":"id","required":true,"in":"path","description":"User ID to delete","schema":{"type":"string"}}],"responses":{"204":{"description":"User deleted successfully"},"403":{"description":"Cannot delete own account or insufficient permissions"}},"tags":["Users"],"security":[{"bearer":[]}]}},"/api/v1/users/{id}/info":{"get":{"operationId":"UserController_getUserInfo","summary":"Get user info by third-party ID","parameters":[{"name":"id","required":true,"in":"path","description":"Third-party user ID","schema":{"type":"string"}}],"responses":{"200":{"description":"User info retrieved successfully"},"403":{"description":"Cannot access other user info without admin permission"}},"tags":["Users"],"security":[{"bearer":[]}]}},"/api/v1/users/setting":{"put":{"operationId":"UserController_updateUserSetting","summary":"Update user settings","parameters":[],"requestBody":{"required":true,"content":{"application/json":{"schema":{"$ref":"#/components/schemas/UpdateUserSettingDto"}}}},"responses":{"200":{"description":"Settings updated successfully"},"403":{"description":"Insufficient permissions"}},"tags":["Users"],"security":[{"bearer":[]}]}},"/api/v1/users/settings-by-page":{"get":{"operationId":"UserController_getAllUserSettingsByPage","summary":"Get all user settings paginated (admin only)","parameters":[{"name":"pageNo","required":true,"in":"query","description":"Page number","schema":{"type":"number"}},{"name":"pageSize","required":true,"in":"query","description":"Page size","schema":{"type":"number"}}],"responses":{"200":{"description":"Settings list retrieved successfully"}},"tags":["Users"],"security":[{"bearer":[]}]}},"/api/v1/users/asset-liability-summary":{"get":{"operationId":"UserController_getAssetLiabilitySummary","summary":"Get asset and liability summary for current user","parameters":[],"responses":{"200":{"description":"Summary retrieved successfully"}},"tags":["Users"],"security":[{"bearer":[]}]}},"/api/v1/admin/properties":{"get":{"operationId":"PropertyController_getAll","summary":"Get all system properties","parameters":[],"responses":{"200":{"description":"Properties retrieved successfully"},"401":{"description":"Unauthorized"},"403":{"description":"Forbidden - insufficient permissions"}},"tags":["Properties"],"security":[{"bearer":[]}]}},"/api/v1/admin/properties/{key}":{"get":{"operationId":"PropertyController_getByKey","summary":"Get property by key","parameters":[{"name":"key","required":true,"in":"path","description":"Property key","schema":{"type":"string"}}],"responses":{"200":{"description":"Property retrieved successfully"},"401":{"description":"Unauthorized"},"403":{"description":"Forbidden - insufficient permissions"},"404":{"description":"Property not found"}},"tags":["Properties"],"security":[{"bearer":[]}]},"put":{"operationId":"PropertyController_","parameters":[],"responses":{"200":{"description":""}},"tags":["Properties"],"security":[{"bearer":[]}]},"delete":{"operationId":"PropertyController_","parameters":[],"responses":{"204":{"description":""}},"tags":["Properties"],"security":[{"bearer":[]}]}},"/api/v1/bean/import/file":{"post":{"operationId":"FileImportController_importFile","summary":"Import a bill file","description":"Upload and process a bill file (CSV, PDF, OFX, etc.). The system automatically identifies the file type, extracts transactions, validates them, and stores only validated transactions to the database. Maximum file size: 50MB. Only 1 import per user at a time (concurrent imports rejected with 429).","parameters":[],"requestBody":{"required":true,"description":"Bill file to import","content":{"multipart/form-data":{"schema":{"$ref":"#/components/schemas/FileImportDto"}}}},"responses":{"200":{"description":"File imported successfully","content":{"application/json":{"schema":{"$ref":"#/components/schemas/ImportResultDto"}}}},"400":{"description":"Bad request - file-format-unsupported or file-import-failed","content":{"application/json":{"schema":{"type":"object","properties":{"type":{"type":"string","example":"file-format-unsupported"},"title":{"type":"string","example":"Unsupported File Format"},"status":{"type":"number","example":400},"detail":{"type":"string","example":"No importer found for this file"},"filename":{"type":"string","example":"unknown.xyz"},"fileSize":{"type":"number","example":12345}}}}}},"413":{"description":"Payload too large - file exceeds 50MB limit","content":{"application/json":{"schema":{"type":"object","properties":{"type":{"type":"string","example":"PAYLOAD_TOO_LARGE"},"title":{"type":"string","example":"File Size Exceeds Limit"},"status":{"type":"number","example":413},"detail":{"type":"string","example":"File exceeds 50MB limit"},"maxSize":{"type":"number","example":52428800},"filename":{"type":"string","example":"large-file.csv"}}}}}},"429":{"description":"Too many requests - user already has import in progress","content":{"application/json":{"schema":{"type":"object","properties":{"type":{"type":"string","example":"IMPORT_IN_PROGRESS"},"title":{"type":"string","example":"Import Already in Progress"},"status":{"type":"number","example":429},"detail":{"type":"string","example":"User already has an import in progress"},"activeImportCount":{"type":"number","example":1},"maxConcurrent":{"type":"number","example":1}}}}}},"500":{"description":"Internal server error - DATABASE_ERROR","content":{"application/json":{"schema":{"$ref":"#/components/schemas/ApiProblemResponseDto"}}}}},"tags":["Bean Import"],"security":[{"bearer":[]}]}},"/api/v1/bean/import/identify":{"post":{"operationId":"FileImportController_identifyFile","summary":"Identify file type","description":"Upload a file to check if it can be processed by any registered importer. Does not perform actual import - useful for pre-validation. Uses user-specific importer configuration.","parameters":[],"requestBody":{"required":true,"description":"File to identify","content":{"multipart/form-data":{"schema":{"$ref":"#/components/schemas/FileImportDto"}}}},"responses":{"200":{"description":"File identification result","content":{"application/json":{"schema":{"$ref":"#/components/schemas/IdentifyResultDto"}}}},"400":{"description":"Bad request - No file uploaded","content":{"application/json":{"schema":{"type":"object","properties":{"type":{"type":"string","example":"INVALID_INPUT"},"title":{"type":"string","example":"Invalid Input"},"status":{"type":"number","example":400},"detail":{"type":"string","example":"No file uploaded"},"endpoint":{"type":"string","example":"/bean/import/identify"}}}}}}},"tags":["Bean Import"],"security":[{"bearer":[]}]}},"/api/v1/bean/import/config/{importerId}":{"get":{"operationId":"ImporterConfigController_getConfig","summary":"Get importer configuration","description":"Returns the current configuration for the specified importer. Creates default configuration if none exists.","parameters":[{"name":"importerId","required":true,"in":"path","description":"Importer identifier. Supported importers: alipay, alipay-web, wechat, boc, boc-credit, ccb, cmb, cmbc, cmbc-credit, icbc, icbc-credit, hsbc-hk","schema":{"example":"alipay","type":"string"}}],"responses":{"200":{"description":"Configuration retrieved successfully","content":{"application/json":{"schema":{"$ref":"#/components/schemas/ImporterConfigDto"}}}},"400":{"description":"Invalid input - Unsupported importer","content":{"application/json":{"schema":{"$ref":"#/components/schemas/ApiProblemResponseDto"}}}},"401":{"description":"Unauthorized - Authentication required","content":{"application/json":{"schema":{"$ref":"#/components/schemas/ApiProblemResponseDto"}}}}},"tags":["Bean Import"],"security":[{"bearer":[]}]},"put":{"operationId":"ImporterConfigController_","parameters":[],"responses":{"200":{"description":""}},"tags":["Bean Import"],"security":[{"bearer":[]}]}},"/api/v1/bean/import/config/{importerId}/reset":{"post":{"operationId":"ImporterConfigController_","parameters":[],"responses":{"201":{"description":""}},"tags":["Bean Import"],"security":[{"bearer":[]}]}},"/api/v1/bean/nlp/process":{"post":{"operationId":"NlpController_processNaturalLanguage","summary":"Process natural language input","description":"Parse natural language text (Chinese/English) describing a transaction. Supports multi-turn dialogue for collecting missing information. When confidence < 0.75, returns \"confirm\" action requiring user verification. User can reply with confirmation words (чбошод/yes/ok) or provide corrections. Examples: \"yesterday Starbucks spent 35 yuan\", \"today lunch 28 yuan\", \"spent $50 at Walmart\"","parameters":[],"requestBody":{"required":true,"description":"Natural language transaction input with optional session ID","content":{"application/json":{"schema":{"$ref":"#/components/schemas/ProcessNlpDto"}}}},"responses":{"200":{"description":"NLP processing result - either created transaction or asking for more info","content":{"application/json":{"schema":{"$ref":"#/components/schemas/NlpResponseDto"}}}},"400":{"description":"Invalid input"},"401":{"description":"Unauthorized"}},"tags":["Bean NLP"],"security":[{"bearer":[]}]}},"/api/v1/bean/nlp/session":{"delete":{"operationId":"NlpController_clearSession","summary":"Clear dialogue session","description":"Clear the current NLP dialogue session. Use this to cancel an ongoing multi-turn dialogue.","parameters":[{"name":"sessionId","required":false,"in":"query","description":"Specific session ID to clear (defaults to user session)","schema":{"type":"string"}}],"responses":{"204":{"description":"Session cleared successfully"},"401":{"description":"Unauthorized"}},"tags":["Bean NLP"],"security":[{"bearer":[]}]},"get":{"operationId":"NlpController_getSession","summary":"Get current session state","description":"Get the current NLP dialogue session state. Useful for debugging and displaying session context in UI.","parameters":[{"name":"sessionId","required":false,"in":"query","description":"Specific session ID to get (defaults to user session)","schema":{"type":"string"}}],"responses":{"200":{"description":"Current session state (or null if no active session)"},"401":{"description":"Unauthorized"}},"tags":["Bean NLP"],"security":[{"bearer":[]}]}},"/api/v1/bean/platforms":{"get":{"operationId":"PlatformController_findAll","summary":"Get all platforms with statistics","parameters":[],"responses":{"200":{"description":"List of platforms with binding and account counts"}},"tags":["Bean Platforms"],"security":[{"bearer":[]}]},"post":{"operationId":"PlatformController_","parameters":[],"responses":{"201":{"description":""}},"tags":["Bean Platforms"],"security":[{"bearer":[]}]}},"/api/v1/bean/platforms/list":{"get":{"operationId":"PlatformController_getPlatformList","summary":"Get platform list for current user","parameters":[],"responses":{"200":{"description":"List of platforms with user binding status"}},"tags":["Bean Platforms"],"security":[{"bearer":[]}]}},"/api/v1/bean/platforms/{id}":{"put":{"operationId":"PlatformController_","parameters":[],"responses":{"200":{"description":""}},"tags":["Bean Platforms"],"security":[{"bearer":[]}]},"delete":{"operationId":"PlatformController_","parameters":[],"responses":{"204":{"description":""}},"tags":["Bean Platforms"],"security":[{"bearer":[]}]}},"/api/v1/bean/platform-bindings":{"get":{"operationId":"BeanPlatformController_findAll","summary":"Get all platform bindings for current user","parameters":[],"responses":{"200":{"description":"List of user platform bindings"}},"tags":["Bean Platform Bindings"],"security":[{"bearer":[]}]},"post":{"operationId":"BeanPlatformController_","parameters":[],"responses":{"201":{"description":""}},"tags":["Bean Platform Bindings"],"security":[{"bearer":[]}]}},"/api/v1/bean/platform-bindings/{bindingId}":{"get":{"operationId":"BeanPlatformController_findOne","summary":"Get a specific platform binding","parameters":[{"name":"bindingId","required":true,"in":"path","description":"Platform binding ID","schema":{"type":"string"}}],"responses":{"200":{"description":"Platform binding details"},"404":{"description":"Platform binding not found"}},"tags":["Bean Platform Bindings"],"security":[{"bearer":[]}]},"put":{"operationId":"BeanPlatformController_","parameters":[],"responses":{"200":{"description":""}},"tags":["Bean Platform Bindings"],"security":[{"bearer":[]}]},"delete":{"operationId":"BeanPlatformController_","parameters":[],"responses":{"204":{"description":""}},"tags":["Bean Platform Bindings"],"security":[{"bearer":[]}]}},"/api/v1/market/symbols/lookup":{"get":{"operationId":"SymbolController_lookupSymbol","summary":"Search for symbols","description":"Search symbols by query with optional filters for asset class, area, and indices","parameters":[{"name":"includeIndices","required":false,"in":"query","description":"Include index symbols in results","schema":{}},{"name":"assetSubClass","required":false,"in":"query","description":"Asset sub-class filter","schema":{}},{"name":"assetClass","required":false,"in":"query","description":"Asset class filter","schema":{}},{"name":"area","required":false,"in":"query","description":"Geographic area filter (e.g., CN, US)","schema":{}},{"name":"query","required":false,"in":"query","description":"Search query string","schema":{}}],"responses":{"200":{"description":"Symbols found successfully"},"400":{"description":"Invalid query parameters"}},"tags":["Symbols"],"security":[{"bearer":[]}]}},"/api/v1/market/symbols/{dataSource}/{symbol}":{"get":{"operationId":"SymbolController_getSymbolData","summary":"Get symbol data","description":"Retrieve detailed symbol information including optional historical data","parameters":[{"name":"dataSource","required":true,"in":"path","description":"Data source provider","schema":{"enum":["ALPHA_VANTAGE","EOD_HISTORICAL_DATA","FINANCIAL_MODELING_PREP","MANUAL","RAPID_API","YAHOO","COINGECKO","TUSHARE","BLOOMBERG","CSI","STOOQ","TRADING_VIEW"],"type":"string"}},{"name":"symbol","required":true,"in":"path","description":"Symbol identifier (e.g., ticker code)","schema":{"type":"string"}},{"name":"includeHistoricalData","required":false,"in":"query","description":"Include historical price data (0 or 1)","schema":{}}],"responses":{"200":{"description":"Symbol data retrieved successfully"},"400":{"description":"Invalid data source"},"404":{"description":"Symbol not found"}},"tags":["Symbols"],"security":[{"bearer":[]}]}},"/api/v1/market/symbols/{dataSource}/{symbol}/{dateString}":{"get":{"operationId":"SymbolController_gatherSymbolForDate","summary":"Gather symbol data for specific date","description":"Retrieve historical symbol data for a specific date","parameters":[{"name":"dataSource","required":true,"in":"path","description":"Data source provider","schema":{"enum":["ALPHA_VANTAGE","EOD_HISTORICAL_DATA","FINANCIAL_MODELING_PREP","MANUAL","RAPID_API","YAHOO","COINGECKO","TUSHARE","BLOOMBERG","CSI","STOOQ","TRADING_VIEW"],"type":"string"}},{"name":"dateString","required":true,"in":"path","description":"Date in ISO 8601 format (YYYY-MM-DD)","schema":{"type":"string"}},{"name":"symbol","required":true,"in":"path","description":"Symbol identifier (e.g., ticker code)","schema":{"type":"string"}}],"responses":{"200":{"description":"Historical data retrieved successfully"},"400":{"description":"Invalid date format"},"404":{"description":"Symbol data not found for specified date"}},"tags":["Symbols"],"security":[{"bearer":[]}]}},"/api/v1/market/symbols/yahoo/batch-update":{"put":{"operationId":"SymbolController_","parameters":[],"responses":{"200":{"description":""}},"tags":["Symbols"],"security":[{"bearer":[]}]}},"/api/v1/cache/flush":{"post":{"operationId":"CacheController_flushCache","parameters":[],"responses":{"201":{"description":""}}}},"/api/v1/dashboard/net-worth":{"get":{"operationId":"DashboardController_getNetWorth","summary":"Get net worth overview","description":"Returns total net worth with breakdown of assets and liabilities","parameters":[{"name":"date","required":false,"in":"query","description":"Date for balance calculation (ISO 8601 format)","schema":{"example":"2024-06-15","type":"string"}}],"responses":{"200":{"description":"Net worth retrieved successfully","content":{"application/json":{"schema":{"$ref":"#/components/schemas/NetWorthResponseDto"}}}},"401":{"description":"User not authenticated"}},"tags":["Dashboard"],"security":[{"bearer":[]}]}},"/api/v1/dashboard/accounts":{"get":{"operationId":"DashboardController_getAccounts","summary":"Get accounts grouped by platform","description":"Returns accounts with balances grouped by financial platform","parameters":[{"name":"groupBy","required":false,"in":"query","description":"Grouping strategy","schema":{"enum":["platform","assetClass"],"type":"string"}},{"name":"date","required":false,"in":"query","description":"Date for balance calculation (ISO 8601 format)","schema":{"example":"2024-06-15","type":"string"}}],"responses":{"200":{"description":"Accounts retrieved successfully","content":{"application/json":{"schema":{"$ref":"#/components/schemas/AccountsResponseDto"}}}},"401":{"description":"User not authenticated"}},"tags":["Dashboard"],"security":[{"bearer":[]}]}},"/api/v1/dashboard/cash-flow":{"get":{"operationId":"DashboardController_getCashFlow","summary":"Get cash flow summary","description":"Returns income, expenses, and savings for a monthly period","parameters":[{"name":"period","required":true,"in":"query","description":"Period in YYYY-MM format","schema":{"example":"2024-06","type":"string"}}],"responses":{"200":{"description":"Cash flow retrieved successfully","content":{"application/json":{"schema":{"$ref":"#/components/schemas/CashFlowResponseDto"}}}},"400":{"description":"Invalid period format"},"401":{"description":"User not authenticated"}},"tags":["Dashboard"],"security":[{"bearer":[]}]}},"/api/v1/reporting/portfolio/trends":{"get":{"operationId":"ReportingController_getPortfolioTrends","summary":"Get portfolio value trends","description":"Returns time series data of portfolio net worth","parameters":[{"name":"period","required":false,"in":"query","description":"Time period","schema":{"default":"6m","enum":["1m","3m","6m","1y"],"type":"string"}},{"name":"granularity","required":false,"in":"query","description":"Data granularity","schema":{"default":"month","enum":["day","week","month"],"type":"string"}}],"responses":{"200":{"description":"Trends retrieved successfully","content":{"application/json":{"schema":{"$ref":"#/components/schemas/PortfolioTrendsResponseDto"}}}},"401":{"description":"User not authenticated"}},"tags":["Reporting"],"security":[{"bearer":[]}]}},"/api/v1/reporting/snapshots/generate":{"post":{"operationId":"ReportingController_generateSnapshot","summary":"Generate portfolio snapshot","description":"Manually generate a portfolio snapshot for today","parameters":[],"responses":{"200":{"description":"Snapshot generated successfully"},"401":{"description":"User not authenticated"}},"tags":["Reporting"],"security":[{"bearer":[]}]}},"/api/v1/reporting/snapshots/backfill":{"post":{"operationId":"ReportingController_backfillSnapshots","summary":"Backfill portfolio snapshots","description":"Generate snapshots for a date range (use for historical data)","parameters":[],"responses":{"200":{"description":"Backfill completed successfully"},"401":{"description":"User not authenticated"}},"tags":["Reporting"],"security":[{"bearer":[]}]}},"/api/v1/auth/api-keys":{"post":{"operationId":"ApiKeysController_","parameters":[],"responses":{"201":{"description":""}},"tags":["API Keys"],"security":[{"bearer":[]}]}},"/api/v1/auth/devices/{id}":{"delete":{"operationId":"AuthDeviceController_deleteAuthDevice","summary":"Delete an auth device","parameters":[{"name":"id","required":true,"in":"path","description":"Auth device ID","schema":{"type":"string"}}],"responses":{"204":{"description":"Device deleted successfully"},"403":{"description":"Access denied - device belongs to another user"},"404":{"description":"Device not found"}},"tags":["Auth Device"],"security":[{"bearer":[]}]}},"/api/v1/auth/sessions/anonymous/{accessToken}":{"get":{"operationId":"AuthController_accessTokenLoginGet","summary":"Anonymous login via URL parameter (deprecated)","deprecated":true,"parameters":[{"name":"accessToken","required":true,"in":"path","schema":{"type":"string"}}],"responses":{"200":{"description":"Login successful"},"401":{"description":"Invalid access token"}},"tags":["Auth"],"security":[{"bearer":[]}]}},"/api/v1/auth/sessions/anonymous":{"post":{"operationId":"AuthController_accessTokenLogin","summary":"Anonymous login with access token","parameters":[],"requestBody":{"required":true,"content":{"application/json":{"schema":{"$ref":"#/components/schemas/AnonymousLoginDto"}}}},"responses":{"200":{"description":"Login successful"},"401":{"description":"Invalid access token"}},"tags":["Auth"],"security":[{"bearer":[]}]}},"/api/v1/auth/sessions/internet-identity":{"post":{"operationId":"AuthController_internetIdentityLogin","summary":"Login with Internet Identity","parameters":[],"requestBody":{"required":true,"content":{"application/json":{"schema":{"$ref":"#/components/schemas/InternetIdentityLoginDto"}}}},"responses":{"200":{"description":"Login successful"},"401":{"description":"Authentication failed"},"403":{"description":"User signup disabled"}},"tags":["Auth"],"security":[{"bearer":[]}]}},"/api/v1/auth/sessions/webauthn/generate-registration-options":{"get":{"operationId":"AuthController_generateRegistrationOptions","summary":"Generate WebAuthn registration options","parameters":[],"responses":{"200":{"description":"Registration options generated"},"401":{"description":"Authentication required"}},"tags":["Auth"],"security":[{"bearer":[]}]}},"/api/v1/auth/sessions/webauthn/verify-attestation":{"post":{"operationId":"AuthController_verifyAttestation","summary":"Verify WebAuthn attestation (device registration)","parameters":[],"requestBody":{"required":true,"content":{"application/json":{"schema":{"$ref":"#/components/schemas/VerifyAttestationDto"}}}},"responses":{"200":{"description":"Device registered successfully"},"401":{"description":"Authentication required"},"500":{"description":"Attestation verification failed"}},"tags":["Auth"],"security":[{"bearer":[]}]}},"/api/v1/auth/sessions/webauthn/generate-assertion-options":{"post":{"operationId":"AuthController_generateAssertionOptions","summary":"Generate WebAuthn assertion options for login","parameters":[],"requestBody":{"required":true,"content":{"application/json":{"schema":{"$ref":"#/components/schemas/GenerateAssertionOptionsDto"}}}},"responses":{"200":{"description":"Assertion options generated"},"404":{"description":"Device not found"}},"tags":["Auth"],"security":[{"bearer":[]}]}},"/api/v1/auth/sessions/webauthn/verify-assertion":{"post":{"operationId":"AuthController_verifyAssertion","summary":"Verify WebAuthn assertion (login)","parameters":[],"requestBody":{"required":true,"content":{"application/json":{"schema":{"$ref":"#/components/schemas/VerifyAssertionDto"}}}},"responses":{"200":{"description":"Login successful"},"401":{"description":"Assertion verification failed"},"404":{"description":"Device not found"}},"tags":["Auth"],"security":[{"bearer":[]}]}},"/api/v1/market/exchange-rates/{symbol}/{dateString}":{"get":{"operationId":"ExchangeRateController_getExchangeRate","summary":"Get exchange rate for currency pair","description":"Retrieves historical exchange rate for a specific date and currency pair","parameters":[{"name":"symbol","required":true,"in":"path","description":"Currency pair symbol (e.g., USDCNY, EURUSD)","schema":{"example":"USDCNY","type":"string"}},{"name":"dateString","required":true,"in":"path","description":"Date in ISO format (YYYY-MM-DD)","schema":{"example":"2024-01-15","type":"string"}}],"responses":{"200":{"description":"Exchange rate retrieved successfully"},"404":{"description":"Exchange rate not found for the specified currency pair and date"}},"tags":["Exchange Rate"],"security":[{"bearer":[]}]}},"/api/v1/health":{"get":{"operationId":"HealthController_getHealth","summary":"Basic health check for K8s/load balancer probes","parameters":[],"responses":{"200":{"description":"Service is healthy"},"503":{"description":"Service unavailable"}},"tags":["Health"],"security":[{"bearer":[]}]}},"/api/v1/health/database":{"get":{"operationId":"HealthController_checkDatabase","summary":"Check database connection health","parameters":[],"responses":{"200":{"description":"Database is healthy"},"503":{"description":"Database unavailable"}},"tags":["Health"],"security":[{"bearer":[]}]}},"/api/v1/health/redis":{"get":{"operationId":"HealthController_checkRedis","summary":"Check Redis connection health","parameters":[],"responses":{"200":{"description":"Redis is healthy"},"503":{"description":"Redis unavailable"}},"tags":["Health"],"security":[{"bearer":[]}]}},"/api/v1/health/circuit-breakers":{"get":{"operationId":"HealthController_getCircuitBreakersHealth","summary":"Get status of all circuit breakers","parameters":[],"responses":{"200":{"description":"Circuit breaker status"},"401":{"description":"Unauthorized"},"500":{"description":"Internal error"}},"tags":["Health"],"security":[{"bearer":[]}]}},"/api/v1/health/circuit-breakers/{name}/reset":{"post":{"operationId":"HealthController_resetCircuitBreaker","summary":"Reset a circuit breaker to CLOSED state","parameters":[{"name":"name","required":true,"in":"path","description":"Circuit breaker name to reset","schema":{"type":"string"}}],"responses":{"200":{"description":"Circuit breaker reset successfully"},"401":{"description":"Unauthorized"},"404":{"description":"Circuit breaker not found"}},"tags":["Health"],"security":[{"bearer":[]}]}},"/api/v1/health/metrics":{"get":{"operationId":"HealthController_getMetrics","summary":"Get health check metrics and statistics","parameters":[],"responses":{"200":{"description":"Health metrics"},"401":{"description":"Unauthorized"}},"tags":["Health"],"security":[{"bearer":[]}]}},"/api/v1/health/data-enhancer/{name}":{"get":{"operationId":"HealthController_getHealthOfDataEnhancer","summary":"Check health of a specific data enhancer","parameters":[{"name":"name","required":true,"in":"path","description":"Data enhancer name","schema":{"type":"string"}}],"responses":{"200":{"description":"Data enhancer is healthy"},"401":{"description":"Unauthorized"},"503":{"description":"Data enhancer unavailable"}},"tags":["Health"],"security":[{"bearer":[]}]}},"/api/v1/health/data-providers":{"get":{"operationId":"HealthController_checkDataProviders","summary":"Check health of all data providers","parameters":[],"responses":{"200":{"description":"Data providers health status"},"401":{"description":"Unauthorized"},"503":{"description":"Data providers check failed"}},"tags":["Health"],"security":[{"bearer":[]}]}},"/api/v1/health/data-provider/{dataSource}":{"get":{"operationId":"HealthController_getHealthOfDataProvider","summary":"Check health of a specific data provider","parameters":[{"name":"dataSource","required":true,"in":"path","description":"Data source identifier","schema":{"type":"string"}}],"responses":{"200":{"description":"Data provider is healthy"},"400":{"description":"Invalid data source"},"401":{"description":"Unauthorized"},"503":{"description":"Data provider unavailable"}},"tags":["Health"],"security":[{"bearer":[]}]}},"/api/v1/system/info":{"get":{"operationId":"InfoController_getInfo","summary":"Get system information","parameters":[],"responses":{"200":{"description":"System information retrieved successfully"}},"tags":["Info"],"security":[{"bearer":[]}]}},"/api/v1/market/logos/{dataSource}/{symbol}":{"get":{"operationId":"LogoController_getLogoByDataSourceAndSymbol","summary":"Get asset logo by data source and symbol","parameters":[{"name":"dataSource","required":true,"in":"path","description":"Data source identifier (e.g., YAHOO, COINGECKO)","schema":{"type":"string"}},{"name":"symbol","required":true,"in":"path","description":"Asset symbol (e.g., AAPL, BTC)","schema":{"type":"string"}}],"responses":{"200":{"description":"Logo image stream (favicon)"},"401":{"description":"Unauthorized"},"404":{"description":"Logo not found for the specified asset"},"503":{"description":"Service unavailable"}},"tags":["Logos"],"security":[{"bearer":[]}]}},"/api/v1/market/logos":{"get":{"operationId":"LogoController_getLogoByUrl","summary":"Get website favicon by URL","parameters":[{"name":"url","required":true,"in":"query","description":"Website URL to fetch favicon from","schema":{"example":"https://example.com","type":"string"}}],"responses":{"200":{"description":"Logo image stream (favicon)"},"401":{"description":"Unauthorized"},"503":{"description":"Service unavailable"}},"tags":["Logos"],"security":[{"bearer":[]}]}},"/api/v1/market-data/{dataSource}/{symbol}":{"get":{"operationId":"MarketDataController_getMarketDataBySymbol","summary":"Get market data by symbol","description":"Retrieves market data and asset profile for a given symbol and data source","parameters":[{"name":"dataSource","required":true,"in":"path","description":"Data source provider","schema":{"enum":["ALPHA_VANTAGE","EOD_HISTORICAL_DATA","FINANCIAL_MODELING_PREP","MANUAL","RAPID_API","YAHOO","COINGECKO","TUSHARE","BLOOMBERG","CSI","STOOQ","TRADING_VIEW"],"type":"string"}},{"name":"symbol","required":true,"in":"path","description":"Symbol code","schema":{"type":"string"}}],"responses":{"200":{"description":"Market data retrieved successfully"},"403":{"description":"Insufficient permissions to read market data"},"404":{"description":"Market data not found"}},"tags":["Market Data"],"security":[{"bearer":[]}]},"post":{"operationId":"MarketDataController_","parameters":[],"responses":{"201":{"description":""}},"tags":["Market Data"],"security":[{"bearer":[]}]}}},"info":{"title":"IGN Beancount SaaS API","description":"\n# IGN Beancount SaaS - Double-Entry Accounting Platform\n\nEnterprise-grade double-entry accounting platform built on the Beancount accounting engine.\n\n## Core Features\n\n- **Double-Entry Bookkeeping**: Full Beancount-compliant transaction and posting system\n- **Multi-Source Import**: CSV, PDF, OFX file import with automatic institution detection\n- **Natural Language Input**: Chinese NLP parser for quick transaction entry\n- **Smart Categorization**: Rule-based automatic transaction classification\n- **Multi-Currency Support**: Handle multiple currencies with price tracking\n\n## Authentication\n\nAll API endpoints (except health checks) require JWT Bearer Token authentication:\n\n```\nAuthorization: Bearer <your-jwt-token>\n```\n\n## API Versioning\n\nCurrent version: **v1**. All paths are prefixed with `/api/v1`\n\n## Response Format\n\n### Success Response\n```json\n{\n  \"id\": \"...\",\n  \"createdAt\": \"2024-01-01T00:00:00Z\",\n  ...\n}\n```\n\n### Error Response (RFC 9457)\n```json\n{\n  \"type\": \"VALIDATION_ERROR\",\n  \"title\": \"Validation Failed\",\n  \"status\": 400,\n  \"detail\": \"Field 'amount' is required\",\n  \"instance\": \"/api/v1/bean/transactions\",\n  \"extensions\": {\n    \"field\": \"amount\",\n    \"constraint\": \"isNotEmpty\"\n  }\n}\n```\n\n## Rate Limiting\n\n- Import operations: 1 concurrent import per user\n- API calls: Standard rate limits apply\n\n## Key Concepts\n\n| Concept | Description |\n|---------|-------------|\n| **Transaction** | A complete accounting entry with balanced postings |\n| **Posting** | A single leg of a transaction (debit or credit) |\n| **Commodity** | Currency or tradeable asset (USD, BTC, AAPL) |\n| **Account** | Hierarchical account path (Assets:Bank:Checking) |\n| **Payee** | Counterparty in a transaction |\n      ","version":"dev","contact":{"name":"IGN Team","url":"https://github.com/anthropics/ign","email":"support@fire-zu.cn"},"license":{"name":"MIT","url":"https://opensource.org/licenses/MIT"}},"tags":[{"name":"Bean Transactions","description":"Create and manage double-entry transactions"},{"name":"Bean - Balances","description":"Query account balances at any point in time"},{"name":"Bean Commodities","description":"Manage currencies and tradeable assets"},{"name":"Bean Payees","description":"Manage transaction counterparties"},{"name":"Bean Prices","description":"Track commodity prices and exchange rates"},{"name":"Bean Import","description":"Import transactions from CSV, PDF, OFX files"},{"name":"Bean NLP","description":"Natural language transaction input (Chinese)"},{"name":"Transaction Rules","description":"Automatic transaction categorization rules"},{"name":"Bean Platforms","description":"Global platform definitions (banks, brokers)"},{"name":"Bean Platform Bindings","description":"User-specific platform configurations"},{"name":"Admin - Payee Profiles","description":"Global payee profile management (admin only)"}],"servers":[],"components":{"securitySchemes":{"JWT-auth":{"scheme":"bearer","bearerFormat":"JWT","type":"http","name":"JWT","description":"Enter JWT Token (no Bearer prefix needed)","in":"header"}},"schemas":{"CreateAccountDto":{"type":"object","properties":{"path":{"type":"string","description":"Account path (hierarchical, colon-separated)","example":"Assets:CN:Bank:ICBC:Checking"},"openDate":{"format":"date-time","type":"string","description":"Account open date","example":"2024-01-01"},"currencies":{"description":"Allowed currencies (null = no restriction)","example":["CNY","USD"],"type":"array","items":{"type":"string"}},"bookingMethod":{"type":"string","description":"Booking method for cost basis","enum":["FIFO","LIFO","HIFO","AVERAGE","STRICT","STRICT_WITH_SIZE","NONE"],"default":"FIFO"},"templatePath":{"type":"string","description":"Reference to account-standards template path","example":"Assets:CN:Bank:ICBC:Checking"},"isCustom":{"type":"boolean","description":"Whether this is a custom (user-created) account","default":false},"i18nKey":{"type":"string","description":"i18n key for display name (overrides template)","example":"account.custom.mybank"},"icon":{"type":"string","description":"Icon identifier (overrides template)","example":"bank-custom"},"openMeta":{"type":"object","description":"Additional metadata","example":{"branch":"Downtown","accountNumber":"1234"}}},"required":["path","openDate"]},"AccountResponseDto":{"type":"object","properties":{"id":{"type":"string","description":"Account UUID","example":"550e8400-e29b-41d4-a716-446655440000"},"path":{"type":"string","description":"Account path (hierarchical, colon-separated)","example":"Assets:CN:Bank:ICBC:Checking"},"type":{"type":"string","description":"Account type (root segment)","enum":["Assets","Liabilities","Income","Expenses","Equity"],"example":"Assets"},"status":{"type":"string","description":"Account status","enum":["OPEN","CLOSED","SUSPENDED"],"example":"OPEN"},"openDate":{"type":"string","description":"Account open date","example":"2024-01-01"},"closeDate":{"type":"string","description":"Account close date (if closed)","example":"2024-12-31"},"currencies":{"description":"Allowed currencies (null = no restriction)","example":["CNY","USD"],"type":"array","items":{"type":"string"}},"bookingMethod":{"type":"string","description":"Booking method","enum":["FIFO","LIFO","HIFO","AVERAGE","STRICT","STRICT_WITH_SIZE","NONE"],"example":"FIFO"},"templatePath":{"type":"string","description":"Template path reference","example":"Assets:CN:Bank:ICBC:Checking"},"isCustom":{"type":"boolean","description":"Whether this is a custom (user-created) account","example":false},"i18nKey":{"type":"string","description":"i18n key for display name","example":"account.assets.cn.bank.icbc.checking"},"icon":{"type":"string","description":"Icon identifier","example":"bank-icbc"},"openMeta":{"type":"object","description":"Account metadata","example":{"branch":"Downtown"}},"createdAt":{"type":"string","description":"Created timestamp","example":"2024-01-01T00:00:00.000Z"},"updatedAt":{"type":"string","description":"Updated timestamp","example":"2024-01-01T00:00:00.000Z"}},"required":["id","path","type","status","openDate","bookingMethod","isCustom","createdAt","updatedAt"]},"AccountListResponseDto":{"type":"object","properties":{"items":{"description":"Array of accounts","type":"array","items":{"$ref":"#/components/schemas/AccountResponseDto"}},"total":{"type":"number","description":"Total number of accounts matching the query","example":50}},"required":["items","total"]},"UpdateAccountDto":{"type":"object","properties":{"currencies":{"description":"Allowed currencies (null = no restriction)","example":["CNY","USD"],"type":"array","items":{"type":"string"}},"bookingMethod":{"type":"string","description":"Booking method for cost basis","enum":["FIFO","LIFO","HIFO","AVERAGE","STRICT","STRICT_WITH_SIZE","NONE"]},"i18nKey":{"type":"string","description":"i18n key for display name","example":"account.custom.mybank"},"icon":{"type":"string","description":"Icon identifier","example":"bank-custom"},"openMeta":{"type":"object","description":"Additional metadata (merged with existing)","example":{"branch":"Uptown"}}}},"CloseAccountDto":{"type":"object","properties":{"closeDate":{"format":"date-time","type":"string","description":"Account close date","example":"2024-12-31"},"closeMeta":{"type":"object","description":"Close directive metadata","example":{"reason":"Account migrated to new bank"}}},"required":["closeDate"]},"ReopenAccountDto":{"type":"object","properties":{"reopenDate":{"format":"date-time","type":"string","description":"New open date (optional)","example":"2025-01-01"}}},"CreatePostingDto":{"type":"object","properties":{"account":{"type":"string","description":"Account name in Beancount format (must start with uppercase, colon-separated)","example":"Assets:Bank:Checking"},"units":{"type":"string","description":"Amount as decimal string (max 15 integer + 15 decimal digits). Can be omitted for interpolation, but currency must also be omitted.","example":"100.50","pattern":"^-?\\d{1,15}(\\.\\d{1,15})?$"},"currency":{"type":"string","description":"Currency/commodity code. Required if units is provided, must be omitted if units is omitted.","example":"USD","maxLength":20},"meta":{"type":"object","description":"Posting-level metadata","example":{"tax-lot":"Q1-2024"}}},"required":["account"]},"CreateTransactionDto":{"type":"object","properties":{"date":{"type":"string","description":"Transaction date (ISO 8601 format)","example":"2024-11-28"},"flag":{"type":"string","description":"Transaction flag: * (cleared), ! (pending)","enum":["*","!"],"example":"*"},"payee":{"type":"string","description":"Payee name","example":"Whole Foods Market"},"narration":{"type":"string","description":"Transaction narration/description","example":"Grocery shopping"},"tags":{"description":"Transaction tags (without # prefix)","example":["vacation","personal"],"type":"array","items":{"type":"string"}},"links":{"description":"Transaction links (without ^ prefix)","example":["invoice-123"],"type":"array","items":{"type":"string"}},"postings":{"description":"Transaction postings (minimum 1, typically 2 for double-entry)","type":"array","items":{"$ref":"#/components/schemas/CreatePostingDto"}},"meta":{"type":"object","description":"Transaction-level metadata","example":{"invoice":"12345"}},"idempotencyKey":{"type":"string","description":"Unique key for idempotent transaction creation. If provided, duplicate requests with the same key will return the existing transaction.","example":"import-2024-01-15-batch-001","maxLength":128}},"required":["date","narration","postings"]},"PostingResponseDto":{"type":"object","properties":{"account":{"type":"string","description":"Account name","example":"Assets:Bank:Checking"},"units":{"type":"string","description":"Amount (may be null if interpolated)","example":"100.50"},"currency":{"type":"string","description":"Currency","example":"USD"}},"required":["account"]},"RecurringSuggestionDto":{"type":"object","properties":{"shouldSuggest":{"type":"boolean","description":"Whether to suggest creating a recurring rule","example":true},"suggestedFrequency":{"type":"string","description":"Suggested frequency based on pattern analysis","enum":["WEEKLY","BIWEEKLY","MONTHLY","BIMONTHLY","QUARTERLY","YEARLY","CUSTOM"],"example":"MONTHLY"},"confidence":{"type":"number","description":"Confidence score (0-1)","minimum":0,"maximum":1,"example":0.75},"similarCount":{"type":"number","description":"Number of similar historical transactions found","minimum":1,"example":3},"averageAmount":{"type":"number","description":"Average amount across similar transactions","example":299},"suggestedExpectedDay":{"type":"number","description":"Suggested expected day of month (1-28). Only provided when dates are consistent.","minimum":1,"maximum":28,"example":15}},"required":["shouldSuggest","suggestedFrequency","confidence","similarCount","averageAmount"]},"TransactionResponseDto":{"type":"object","properties":{"transactionId":{"type":"string","description":"Database transaction ID","example":"clh1234567890abcdef"},"idempotencyKey":{"type":"string","description":"Idempotency key if provided during creation"},"date":{"type":"string","description":"Transaction date","example":"2024-11-28"},"flag":{"type":"string","description":"Transaction flag","example":"*"},"payee":{"type":"string","description":"Payee name","example":"Whole Foods Market"},"narration":{"type":"string","description":"Transaction narration","example":"Grocery shopping"},"postings":{"description":"Transaction postings","type":"array","items":{"$ref":"#/components/schemas/PostingResponseDto"}},"interpolated":{"type":"boolean","description":"Whether interpolation was applied to balance the transaction","example":false},"booked":{"type":"boolean","description":"Whether booking (cost resolution) was applied","example":false},"warnings":{"description":"Non-blocking warnings from pipeline processing","example":["Posting amount precision truncated"],"type":"array","items":{"type":"string"}},"createdAccountIds":{"description":"Account IDs auto-created for this transaction (empty for API source)","example":[],"type":"array","items":{"type":"string"}},"recurringSuggestion":{"description":"Recurring rule creation suggestion. Only present when no existing rule matched and similar historical transactions were detected.","allOf":[{"$ref":"#/components/schemas/RecurringSuggestionDto"}]}},"required":["transactionId","date","narration","postings","interpolated","booked","createdAccountIds"]},"ApiProblemResponseDto":{"type":"object","properties":{"type":{"type":"string","description":"A URI reference that identifies the problem type","example":"/errors/resource-not-found"},"title":{"type":"string","description":"A short, human-readable summary of the problem","example":"Resource not found"},"status":{"type":"number","description":"The HTTP status code","example":404},"detail":{"type":"string","description":"A human-readable explanation of the problem","example":"The requested resource with ID uuid-123 does not exist"},"instance":{"type":"string","description":"A URI reference that identifies the specific occurrence","example":"/api/v1/resources/uuid-123"},"extensions":{"type":"object","description":"Additional extension data","example":{"resourceId":"uuid-123","operation":"findById"}}},"required":["type","title","status","detail"]},"PostingDetailDto":{"type":"object","properties":{"id":{"type":"string","description":"Posting ID","example":"clh1234567890abcdef"},"accountId":{"type":"string","description":"Account ID","example":"clh1234567890abcdef"},"accountName":{"type":"string","description":"Account name","example":"Assets:Bank:Checking"},"units":{"type":"string","description":"Amount (may be null if interpolated)","example":"100.50"},"currency":{"type":"string","description":"Currency","example":"USD"},"costAmount":{"type":"string","description":"Cost amount","example":"98.00"},"costCurrency":{"type":"string","description":"Cost currency","example":"USD"},"costDate":{"type":"string","description":"Cost date","example":"2024-01-15"},"priceAmount":{"type":"string","description":"Price amount","example":"1.02"},"priceCurrency":{"type":"string","description":"Price currency","example":"EUR"},"flag":{"type":"string","description":"Posting flag","example":"*"},"meta":{"type":"object","description":"Posting metadata"}},"required":["id","accountId","accountName"]},"TransactionDetailDto":{"type":"object","properties":{"id":{"type":"string","description":"Transaction ID","example":"clh1234567890abcdef"},"date":{"type":"string","description":"Transaction date","example":"2024-11-28"},"flag":{"type":"string","description":"Transaction flag","enum":["CLEARED","PENDING","PADDING","SUMMARIZE","TRANSFER","CONVERSIONS"],"example":"CLEARED"},"customFlag":{"type":"string","description":"Custom flag (if not using standard flags)","example":"R"},"payee":{"type":"string","description":"Payee name","example":"Whole Foods Market"},"narration":{"type":"string","description":"Transaction narration","example":"Grocery shopping"},"tags":{"description":"Transaction tags","example":["groceries"],"type":"array","items":{"type":"string"}},"links":{"description":"Transaction links","example":["invoice-2024-001"],"type":"array","items":{"type":"string"}},"meta":{"type":"object","description":"Transaction metadata"},"status":{"type":"string","description":"Transaction status","enum":["ACTIVE","VOIDED","SUPERSEDED"],"example":"ACTIVE"},"sourceType":{"type":"string","description":"Source type (how the transaction was created)","enum":["NLP","CSV","OCR","API"]},"sourcePlatform":{"type":"string","description":"Source platform (e.g., alipay, wechat)","example":"alipay"},"postings":{"description":"Transaction postings","type":"array","items":{"$ref":"#/components/schemas/PostingDetailDto"}},"createdAt":{"type":"string","description":"Created at timestamp","example":"2024-11-28T10:30:00.000Z"},"voidedAt":{"type":"string","description":"Voided at timestamp (if voided)","example":"2024-11-29T15:00:00.000Z"},"voidedBy":{"type":"string","description":"User ID who voided this transaction","example":"clh1234567890abcdef"},"correctionReason":{"type":"string","description":"Correction reason (if voided or superseded)","example":"Duplicate entry"}},"required":["id","date","narration","tags","links","status","postings","createdAt"]},"TransactionListResponseDto":{"type":"object","properties":{"data":{"description":"List of transactions","type":"array","items":{"$ref":"#/components/schemas/TransactionDetailDto"}},"total":{"type":"number","description":"Total count of matching transactions","example":100},"limit":{"type":"number","description":"Number of items per page","example":20},"offset":{"type":"number","description":"Number of items skipped","example":0}},"required":["data","total","limit","offset"]},"UpdateTransactionDto":{"type":"object","properties":{"flag":{"type":"string","description":"Transaction flag (CLEARED, PENDING, etc.)","enum":["CLEARED","PENDING","PADDING","SUMMARIZE","TRANSFER","CONVERSIONS"],"example":"CLEARED"},"payee":{"type":"string","description":"Payee name","maxLength":500,"example":"Whole Foods Market"},"narration":{"type":"string","description":"Transaction narration/description","maxLength":1000,"example":"Weekly grocery shopping"},"tags":{"description":"Transaction tags","maxItems":50,"example":["groceries","weekly"],"type":"array","items":{"type":"string"}},"links":{"description":"Transaction links","maxItems":50,"example":["invoice-2024-001"],"type":"array","items":{"type":"string"}},"meta":{"type":"object","description":"Transaction metadata (JSON object)","example":{"category":"Food:Groceries","reviewed":true}}}},"AccountStandardResponseDto":{"type":"object","properties":{"path":{"type":"string","description":"Account path (hierarchical, colon-separated)","example":"Assets:CN:Bank:ICBC:Checking"},"i18nKey":{"type":"string","description":"i18n key for localized display name","example":"account.assets.cn.bank.icbc.checking"},"description":{"type":"string","description":"Account description","example":"ICBC checking account for daily transactions"},"tags":{"description":"Account tags for categorization","example":["bank","checking","primary"],"type":"array","items":{"type":"string"}},"icon":{"type":"string","description":"Icon identifier for UI display","example":"bank-icbc"}},"required":["path","i18nKey"]},"AccountStandardListResponseDto":{"type":"object","properties":{"items":{"description":"Array of account templates","type":"array","items":{"$ref":"#/components/schemas/AccountStandardResponseDto"}},"total":{"type":"number","description":"Total number of account templates","example":150},"region":{"type":"string","description":"Region code","example":"CN"}},"required":["items","total","region"]},"BalanceResponseDto":{"type":"object","properties":{"account":{"type":"string","description":"Account name","example":"Assets:Bank:Checking"},"balance":{"type":"string","description":"Balance amount (decimal string for precision)","example":"12345.67"},"currency":{"type":"string","description":"Currency code","example":"USD"},"date":{"type":"string","description":"Date of the balance calculation (ISO 8601)","example":"2024-12-31T00:00:00.000Z"}},"required":["account","balance","currency","date"]},"MultiCurrencyBalanceResponseDto":{"type":"object","properties":{"account":{"type":"string","description":"Account name","example":"Assets:Bank:Checking"},"balances":{"type":"object","description":"Balances by currency","example":{"USD":"12345.67","CNY":"100000.00"}},"date":{"type":"string","description":"Date of the balance calculation (ISO 8601)","example":"2024-12-31T00:00:00.000Z"}},"required":["account","balances","date"]},"ReviewSummaryDto":{"type":"object","properties":{"id":{"type":"string","description":"Review item ID"},"type":{"type":"string","description":"Review type","enum":["DUPLICATE","RULE_MATCH","PAYEE_MATCH","ACCOUNT_VALIDATION","PIPELINE_ERROR"]},"status":{"type":"string","description":"Review status","enum":["PENDING","RESOLVED","EXPIRED","CANCELLED"]},"confidence":{"type":"number","description":"Confidence score (0-1)"},"confidenceLevel":{"type":"string","description":"Confidence level derived from score","enum":["HIGH","MEDIUM","LOW"]},"summary":{"type":"string","description":"Human-readable summary of the review item"},"matchReasons":{"description":"Human-readable reasons for branching","type":"array","items":{"type":"string"}},"sourceType":{"type":"string","description":"Source type (NLP, CSV, OCR, API)"},"sourcePlatform":{"type":"string","description":"Source platform (e.g., alipay, wechat)"},"createdAt":{"format":"date-time","type":"string","description":"Creation timestamp"}},"required":["id","type","status","confidence","confidenceLevel","summary","matchReasons","sourceType","createdAt"]},"ReviewListResponseDto":{"type":"object","properties":{"items":{"type":"array","items":{"$ref":"#/components/schemas/ReviewSummaryDto"}},"total":{"type":"number","description":"Total number of items"},"page":{"type":"number","description":"Current page number"},"limit":{"type":"number","description":"Items per page"},"hasMore":{"type":"boolean","description":"Whether there are more pages"}},"required":["items","total","page","limit","hasMore"]},"ReviewStatsDto":{"type":"object","properties":{"total":{"type":"number","description":"Total pending reviews"},"byType":{"type":"object","description":"Count by type"},"oldestPending":{"format":"date-time","type":"string","description":"Oldest pending review date"}},"required":["total","byType"]},"DecisionOptionDto":{"type":"object","properties":{"value":{"type":"string","description":"The action value to submit (e.g., UPGRADE_REPLACE, ACCEPT)"},"labelKey":{"type":"string","description":"i18n message key for display label (e.g., review.payee.accept.label)"},"descriptionKey":{"type":"string","description":"i18n message key for description"},"recommended":{"type":"boolean","description":"Whether this is the recommended option"}},"required":["value","labelKey"]},"ReviewDetailDto":{"type":"object","properties":{"id":{"type":"string","description":"Review item ID"},"type":{"type":"string","description":"Review type","enum":["DUPLICATE","RULE_MATCH","PAYEE_MATCH","ACCOUNT_VALIDATION","PIPELINE_ERROR"]},"status":{"type":"string","description":"Review status","enum":["PENDING","RESOLVED","EXPIRED","CANCELLED"]},"confidence":{"type":"number","description":"Confidence score (0-1)"},"confidenceLevel":{"type":"string","description":"Confidence level derived from score","enum":["HIGH","MEDIUM","LOW"]},"summary":{"type":"string","description":"Human-readable summary of the review item"},"matchReasons":{"description":"Human-readable reasons for branching","type":"array","items":{"type":"string"}},"sourceType":{"type":"string","description":"Source type (NLP, CSV, OCR, API)"},"sourcePlatform":{"type":"string","description":"Source platform (e.g., alipay, wechat)"},"createdAt":{"format":"date-time","type":"string","description":"Creation timestamp"},"reviewData":{"type":"object","description":"Review-type-specific data (JSONB). Structure varies by type: DUPLICATE: {newTransaction, existingTransaction, matchScore}, RULE_MATCH: {transaction, matchedRule, suggestedAccount}, PAYEE_MATCH: {originalPayee, suggestedPayee}, ACCOUNT_VALIDATION: {invalidAccount, suggestedCorrection, similarAccounts}, PIPELINE_ERROR: {errorType, errorMessage}"},"decisionOptions":{"description":"Available decision options","type":"array","items":{"$ref":"#/components/schemas/DecisionOptionDto"}},"transactionId":{"type":"string","description":"Related transaction ID if applicable"}},"required":["id","type","status","confidence","confidenceLevel","summary","matchReasons","sourceType","createdAt","reviewData","decisionOptions"]},"PayeeResponseDto":{"type":"object","properties":{"id":{"type":"string","description":"Unique identifier (UUID)","example":"uuid-123-456"},"userId":{"type":"string","description":"User ID (owner of this payee mapping)","example":"user-123"},"payee":{"type":"string","description":"User's original payee name (e.g., 'Starbucks', 'McDonald')","example":"Starbucks"},"payeeProfileId":{"type":"object","description":"Reference to global PayeeProfile (merchant info, i18n keys, categories)","example":"uuid-789","nullable":true},"customCategory":{"type":"object","description":"User's custom category (overrides PayeeProfile category if set)","example":"Dining:Coffee","nullable":true},"customTags":{"description":"User's custom tags (e.g., ['favorite', 'work_meal'])","example":["favorite","work_meal"],"type":"array","items":{"type":"string"}},"useCount":{"type":"number","description":"Usage count (number of times this payee was used in transactions)","example":42},"lastUsedAt":{"format":"date-time","type":"string","description":"Last used timestamp","example":"2024-11-20T10:00:00Z"},"meta":{"type":"object","description":"Extended metadata (location, notes, contact info, etc.)","example":{"location":"Zhongguancun","note":"Near subway station","favorite":true}},"isActive":{"type":"boolean","description":"Active status (inactive payees hidden from autocomplete)","example":true},"createdAt":{"format":"date-time","type":"string","description":"Creation timestamp (first time this payee was used)","example":"2024-01-01T10:00:00Z"},"updatedAt":{"format":"date-time","type":"string","description":"Last update timestamp","example":"2024-11-20T10:00:00Z"}},"required":["id","userId","payee","customTags","useCount","lastUsedAt","meta","isActive","createdAt","updatedAt"]},"PayeeListResponseDto":{"type":"object","properties":{"items":{"description":"List of payees","type":"array","items":{"$ref":"#/components/schemas/PayeeResponseDto"}},"total":{"type":"number","description":"Total number of payees","example":42}},"required":["items","total"]},"PayeeAutocompleteResponseDto":{"type":"object","properties":{"suggestions":{"description":"List of matching payee names","example":["Starbucks","Starbucks Coffee","Starbucks Reserve"],"type":"array","items":{"type":"string"}}},"required":["suggestions"]},"PayeeStatsResponseDto":{"type":"object","properties":{"payee":{"type":"string","description":"Payee name","example":"Starbucks"},"transactionCount":{"type":"number","description":"Total transaction count","example":42},"lastUsedAt":{"format":"date-time","type":"string","description":"Last used timestamp","example":"2024-11-20T10:00:00Z"}},"required":["payee","transactionCount","lastUsedAt"]},"PayeeProfileResponseDto":{"type":"object","properties":{"id":{"type":"string","description":"Unique identifier (UUID)","example":"550e8400-e29b-41d4-a716-446655440000"},"canonical":{"type":"string","description":"Canonical payee name (unique, case-insensitive)","example":"Starbucks"},"aliases":{"description":"Multi-language aliases","example":["Starbucks Coffee","SBUX"],"type":"array","items":{"type":"string"}},"i18nKey":{"type":"object","description":"Translation key for i18n","example":"payee.starbucks","nullable":true},"category":{"type":"string","description":"Payee category","enum":["RESTAURANT","CAFE","FAST_FOOD","BAR","SUPERMARKET","CONVENIENCE_STORE","SHOPPING_MALL","ONLINE_SHOPPING","TAXI","RIDE_SHARING","PUBLIC_TRANSPORT","PARKING","GAS_STATION","UTILITIES","TELECOM","STREAMING","HEALTHCARE","EDUCATION","ENTERTAINMENT","SPORTS","TRAVEL","HOTEL","OTHER"],"example":"CAFE"},"subCategory":{"type":"object","description":"Sub-category","example":"coffee_chain","nullable":true},"countries":{"description":"Country codes where payee operates","example":["CN","US","JP"],"type":"array","items":{"type":"string"}},"primaryCountry":{"type":"object","description":"Primary operating country","example":"US","nullable":true},"keywords":{"description":"Search keywords","example":["coffee","cafe"],"type":"array","items":{"type":"string"}},"logoUrl":{"type":"object","description":"Logo URL","example":"https://example.com/logo.png","nullable":true},"website":{"type":"object","description":"Official website","example":"https://www.starbucks.com","nullable":true},"description":{"type":"object","description":"Description","example":"Global coffeehouse chain","nullable":true},"meta":{"type":"object","description":"Extended metadata"},"dataSource":{"type":"string","description":"Data source","enum":["MANUAL","IMPORT","API","CROWDSOURCED"],"example":"MANUAL"},"verifiedAt":{"type":"object","description":"Verification timestamp (null if not verified)","example":"2025-01-01T00:00:00.000Z","nullable":true},"isActive":{"type":"boolean","description":"Whether the profile is active","example":true},"createdAt":{"format":"date-time","type":"string","description":"Creation timestamp","example":"2025-01-01T00:00:00.000Z"},"updatedAt":{"format":"date-time","type":"string","description":"Last update timestamp","example":"2025-01-01T00:00:00.000Z"}},"required":["id","canonical","aliases","category","countries","keywords","meta","dataSource","isActive","createdAt","updatedAt"]},"PayeeProfileListResponseDto":{"type":"object","properties":{"items":{"description":"List of payee profiles","type":"array","items":{"$ref":"#/components/schemas/PayeeProfileResponseDto"}},"total":{"type":"number","description":"Total count of matching records","example":100}},"required":["items","total"]},"CommodityResponseDto":{"type":"object","properties":{"id":{"type":"string","description":"Unique identifier","example":"uuid-123-456"},"userId":{"type":"object","description":"User ID (owner of the commodity)","example":"user-123","nullable":true},"symbol":{"type":"string","description":"Commodity symbol (corresponds to Beancount currency field)","example":"AAPL"},"date":{"type":"string","description":"Commodity definition date (required per Beancount spec). Represents when this commodity was first defined in the accounting system.","example":"2024-01-01","format":"date"},"metadata":{"type":"object","description":"Metadata (corresponds to Beancount meta field). Contains name, assetClass, precision, note, tags, etc.","example":{"name":"Apple Inc.","assetClass":"stock","precision":2,"note":"Tech stock","source":"AUTO_CREATED"}},"symbolProfileId":{"type":"object","description":"Reference to SymbolProfile (market data integration, SaaS feature)","example":"uuid-789","nullable":true},"createdAt":{"format":"date-time","type":"string","description":"Creation timestamp","example":"2024-11-03T10:00:00Z"},"updatedAt":{"format":"date-time","type":"string","description":"Last update timestamp","example":"2024-11-03T10:00:00Z"}},"required":["id","symbol","date","metadata","createdAt","updatedAt"]},"CommodityListResponseDto":{"type":"object","properties":{"items":{"description":"List of commodities","type":"array","items":{"$ref":"#/components/schemas/CommodityResponseDto"}},"total":{"type":"number","description":"Total number of commodities","example":42}},"required":["items","total"]},"RecurringRuleResponseDto":{"type":"object","properties":{"id":{"type":"string","description":"Rule ID"},"userId":{"type":"string","description":"User ID"},"name":{"type":"string","description":"Rule name"},"icon":{"type":"object","description":"Icon emoji"},"frequency":{"type":"string","description":"Recurring frequency"},"expectedAmount":{"type":"number","description":"Expected amount"},"expectedDay":{"type":"object","description":"Expected day of month"},"customIntervalDays":{"type":"object","description":"Custom interval in days"},"currency":{"type":"string","description":"Currency code"},"matchPayeePattern":{"type":"object","description":"Payee matching pattern"},"matchAmountTolerance":{"type":"number","description":"Amount tolerance percentage"},"defaultExpenseAccount":{"type":"object","description":"Default expense account"},"defaultPaymentAccount":{"type":"object","description":"Default payment account"},"defaultPayee":{"type":"object","description":"Default payee"},"isActive":{"type":"boolean","description":"Whether rule is active"},"startDate":{"type":"string","description":"Rule start date (YYYY-MM-DD)"},"endDate":{"type":"object","description":"Rule end date (YYYY-MM-DD)"},"autoCreate":{"type":"boolean","description":"Auto-create transaction on expected date"},"lastOccurrence":{"type":"object","description":"Last matched occurrence date (YYYY-MM-DD)"},"totalCount":{"type":"number","description":"Total matched transactions count"},"createdAt":{"format":"date-time","type":"string","description":"Created at timestamp"},"updatedAt":{"format":"date-time","type":"string","description":"Updated at timestamp"}},"required":["id","userId","name","frequency","expectedAmount","currency","matchAmountTolerance","isActive","startDate","autoCreate","totalCount","createdAt","updatedAt"]},"RecurringRuleWithStatsResponseDto":{"type":"object","properties":{"id":{"type":"string","description":"Rule ID"},"userId":{"type":"string","description":"User ID"},"name":{"type":"string","description":"Rule name"},"icon":{"type":"object","description":"Icon emoji"},"frequency":{"type":"string","description":"Recurring frequency"},"expectedAmount":{"type":"number","description":"Expected amount"},"expectedDay":{"type":"object","description":"Expected day of month"},"customIntervalDays":{"type":"object","description":"Custom interval in days"},"currency":{"type":"string","description":"Currency code"},"matchPayeePattern":{"type":"object","description":"Payee matching pattern"},"matchAmountTolerance":{"type":"number","description":"Amount tolerance percentage"},"defaultExpenseAccount":{"type":"object","description":"Default expense account"},"defaultPaymentAccount":{"type":"object","description":"Default payment account"},"defaultPayee":{"type":"object","description":"Default payee"},"isActive":{"type":"boolean","description":"Whether rule is active"},"startDate":{"type":"string","description":"Rule start date (YYYY-MM-DD)"},"endDate":{"type":"object","description":"Rule end date (YYYY-MM-DD)"},"autoCreate":{"type":"boolean","description":"Auto-create transaction on expected date"},"lastOccurrence":{"type":"object","description":"Last matched occurrence date (YYYY-MM-DD)"},"totalCount":{"type":"number","description":"Total matched transactions count"},"createdAt":{"format":"date-time","type":"string","description":"Created at timestamp"},"updatedAt":{"format":"date-time","type":"string","description":"Updated at timestamp"},"pendingCount":{"type":"number","description":"Number of pending expected transactions"},"overdueCount":{"type":"number","description":"Number of overdue expected transactions"},"nextExpectedDate":{"type":"object","description":"Next expected date (YYYY-MM-DD)"},"totalAmount":{"type":"number","description":"Total amount of all matched transactions"},"averageAmount":{"type":"number","description":"Average amount per transaction"},"transactionCount":{"type":"number","description":"Number of matched transactions"},"firstDate":{"type":"object","description":"First matched transaction date (YYYY-MM-DD)"},"lastDate":{"type":"object","description":"Last matched transaction date (YYYY-MM-DD)"},"variance":{"type":"number","description":"Amount variance (standard deviation squared)"},"upcomingCount":{"type":"number","description":"Number of upcoming expected transactions"}},"required":["id","userId","name","frequency","expectedAmount","currency","matchAmountTolerance","isActive","startDate","autoCreate","totalCount","createdAt","updatedAt","pendingCount","overdueCount","totalAmount","averageAmount","transactionCount","variance","upcomingCount"]},"ExpectedTransactionRuleDto":{"type":"object","properties":{"name":{"type":"string","description":"Rule name"},"icon":{"type":"object","description":"Rule icon"},"frequency":{"type":"string","description":"Rule frequency"},"currency":{"type":"string","description":"Currency code"}},"required":["name","frequency","currency"]},"ExpectedTransactionResponseDto":{"type":"object","properties":{"id":{"type":"string","description":"Expected transaction ID"},"userId":{"type":"string","description":"User ID"},"ruleId":{"type":"string","description":"Associated rule ID"},"expectedDate":{"type":"string","description":"Expected date (YYYY-MM-DD)"},"expectedAmount":{"type":"number","description":"Expected amount"},"status":{"type":"string","description":"Status (PENDING, COMPLETED, SKIPPED)"},"matchedTransactionId":{"type":"object","description":"Matched transaction ID"},"matchedAt":{"type":"object","description":"Match timestamp (ISO 8601)"},"matchConfidence":{"type":"object","description":"Match confidence score (0-1)"},"isOverdue":{"type":"boolean","description":"Whether this expected transaction is overdue"},"rule":{"description":"Rule information","allOf":[{"$ref":"#/components/schemas/ExpectedTransactionRuleDto"}]},"createdAt":{"format":"date-time","type":"string","description":"Created at timestamp"},"updatedAt":{"format":"date-time","type":"string","description":"Updated at timestamp"}},"required":["id","userId","ruleId","expectedDate","expectedAmount","status","isOverdue","rule","createdAt","updatedAt"]},"ExpectedTransactionListResponseDto":{"type":"object","properties":{"items":{"type":"array","items":{"$ref":"#/components/schemas/ExpectedTransactionResponseDto"}},"total":{"type":"number","description":"Total count"}},"required":["items","total"]},"ForecastItemDto":{"type":"object","properties":{"rule":{"type":"string","description":"Rule name","example":"Rent"},"ruleId":{"type":"string","description":"Rule ID","example":"clx123..."},"amount":{"type":"number","description":"Expected amount","example":3000},"date":{"type":"string","description":"Expected date (YYYY-MM-DD)","example":"2024-04-01"},"icon":{"type":"object","description":"Rule icon emoji","example":"ЁЯПа","nullable":true},"currency":{"type":"string","description":"Currency code","example":"CNY"}},"required":["rule","ruleId","amount","date","icon","currency"]},"MonthlyForecastDto":{"type":"object","properties":{"month":{"type":"string","description":"Month (YYYY-MM)","example":"2024-04"},"expectedOutflow":{"type":"number","description":"Total expected outflow for the month","example":8500},"itemCount":{"type":"number","description":"Number of expected transactions","example":3},"byCurrency":{"type":"object","description":"Breakdown by currency","example":{"CNY":8500,"USD":100}},"items":{"description":"Individual forecast items","type":"array","items":{"$ref":"#/components/schemas/ForecastItemDto"}}},"required":["month","expectedOutflow","itemCount","byCurrency","items"]},"ForecastResponseDto":{"type":"object","properties":{"forecast":{"description":"Monthly forecast data","type":"array","items":{"$ref":"#/components/schemas/MonthlyForecastDto"}},"totalOutflow":{"type":"number","description":"Total expected outflow across all months","example":25500},"totalByCurrency":{"type":"object","description":"Total by currency across all months","example":{"CNY":25500,"USD":300}},"rulesCount":{"type":"number","description":"Number of active recurring rules included","example":5},"periodStart":{"type":"string","description":"Forecast period start date","example":"2024-04-01"},"periodEnd":{"type":"string","description":"Forecast period end date","example":"2024-06-30"}},"required":["forecast","totalOutflow","totalByCurrency","rulesCount","periodStart","periodEnd"]},"TransactionRuleResponseDto":{"type":"object","properties":{"id":{"type":"string","description":"Rule ID"},"name":{"type":"string","description":"Rule name"},"description":{"type":"string","description":"Rule description"},"narrationKeywords":{"description":"Keywords to match in transaction narration","type":"array","items":{"type":"string"}},"payeeKeywords":{"description":"Keywords to match in payee name","type":"array","items":{"type":"string"}},"categoryKeywords":{"description":"Keywords to match in category","type":"array","items":{"type":"string"}},"methodKeywords":{"description":"Keywords to match in payment method","type":"array","items":{"type":"string"}},"categoryAccount":{"type":"string","description":"Destination account for categorization"},"matchLogic":{"type":"string","description":"Keyword matching logic","enum":["OR","AND"],"example":"OR"},"amountRange":{"type":"object","description":"Amount range for matching","example":{"min":0,"max":100}},"priority":{"type":"number","description":"Rule priority (0-1000, higher = first match)","example":50},"enabled":{"type":"boolean","description":"Whether the rule is enabled"},"learningSource":{"type":"string","description":"Learning source: NLP, REVIEW_CENTER, or null for manual","enum":["NLP","REVIEW_CENTER"],"example":"REVIEW_CENTER"},"autoApplyEnabled":{"type":"boolean","description":"Whether auto-apply is enabled for this rule"},"confirmationCount":{"type":"number","description":"Number of confirmations for NLP-learned rules","example":3},"additionalTags":{"description":"Additional tags","type":"array","items":{"type":"string"}},"additionalMetadata":{"type":"object","description":"Additional metadata","example":{}},"createdAt":{"format":"date-time","type":"string","description":"Created timestamp"},"updatedAt":{"format":"date-time","type":"string","description":"Updated timestamp"}},"required":["id","name","narrationKeywords","payeeKeywords","categoryKeywords","methodKeywords","matchLogic","priority","enabled","autoApplyEnabled","confirmationCount","additionalTags","createdAt","updatedAt"]},"TransactionRuleListResponseDto":{"type":"object","properties":{"data":{"type":"array","items":{"$ref":"#/components/schemas/TransactionRuleResponseDto"}},"total":{"type":"number","description":"Total count of rules"},"limit":{"type":"number","description":"Results per page"},"offset":{"type":"number","description":"Pagination offset"}},"required":["data","total","limit","offset"]},"ValidateRuleDto":{"type":"object","properties":{"name":{"type":"string","minLength":1,"maxLength":100},"description":{"type":"string","maxLength":500},"narrationKeywords":{"items":{"type":"array"},"maxItems":50,"type":"array"},"payeeKeywords":{"items":{"type":"array"},"maxItems":50,"type":"array"},"categoryKeywords":{"items":{"type":"array"},"maxItems":50,"type":"array"},"methodKeywords":{"items":{"type":"array"},"maxItems":50,"description":"Payment method keywords (e.g., HuaBei, YuEBao)","type":"array"},"categoryAccount":{"type":"string","maxLength":200,"description":"Destination account for expenses/income (e.g., Expenses:Food:Coffee)"},"matchLogic":{"type":"string","enum":["OR","AND"],"default":"OR"},"amountMin":{"type":"number","minimum":0,"description":"Minimum transaction amount (inclusive)"},"amountMax":{"type":"number","minimum":0,"description":"Maximum transaction amount (inclusive)"},"priority":{"type":"number","default":50,"minimum":0,"maximum":1000},"additionalTags":{"items":{"type":"array"},"maxItems":20,"type":"array"},"additionalMetadata":{"type":"object"},"upsertByPayee":{"type":"boolean","description":"If true, update existing rule with matching payeeKeywords[0] instead of creating new rule"}},"required":["name","matchLogic","priority"]},"ValidateRuleResponseDto":{"type":"object","properties":{"valid":{"type":"boolean","description":"Whether the rule configuration is valid","example":true},"errors":{"description":"List of validation errors (empty if valid)","example":[],"items":{"type":"array"},"type":"array"},"warnings":{"description":"List of validation warnings (non-blocking issues)","example":["No account constraints specified - rule will match any account"],"items":{"type":"array"},"type":"array"}},"required":["valid","errors","warnings"]},"ExportRulesResponseDto":{"type":"object","properties":{"exportedAt":{"type":"string","description":"Export timestamp"},"userId":{"type":"string","description":"User ID"},"ruleCount":{"type":"number","description":"Number of exported rules"},"rules":{"type":"array","description":"Exported rules"}},"required":["exportedAt","userId","ruleCount","rules"]},"RuleStatisticsResponseDto":{"type":"object","properties":{"period":{"type":"string","description":"Statistics time period","enum":["7d","30d","90d"]},"totalRules":{"type":"number","description":"Total number of rules"},"rulesWithMatches":{"type":"number","description":"Number of rules with at least one match"},"totalMatches":{"type":"number","description":"Total number of matches across all rules"},"averageConfidence":{"type":"number","description":"Average confidence score across all matches","example":0.82},"ruleStats":{"type":"array","description":"Per-rule statistics","items":{"type":"object","properties":{"ruleId":{"type":"string"},"ruleName":{"type":"string"},"matchCount":{"type":"number"},"averageConfidence":{"type":"number"}}}}},"required":["period","totalRules","rulesWithMatches","totalMatches","averageConfidence","ruleStats"]},"TestRuleDto":{"type":"object","properties":{"narration":{"type":"string","minLength":1,"maxLength":500},"payee":{"type":"string","maxLength":200},"categoryAccount":{"type":"string","maxLength":200},"amount":{"type":"number"},"currency":{"type":"string","maxLength":10}},"required":["narration"]},"TestRuleResponseDto":{"type":"object","properties":{"ruleId":{"type":"string","description":"Rule ID that was tested"},"matches":{"type":"boolean","description":"Whether the rule matched the test data"},"confidence":{"type":"number","description":"Match confidence score (0-1)","example":0.85},"matchDetails":{"type":"object","description":"Details of which fields matched","example":{"narration":true,"payee":false,"categoryAccount":false}}},"required":["ruleId","matches","confidence","matchDetails"]},"DeleteOwnUserDto":{"type":"object","properties":{"accessToken":{"type":"string","description":"Access token for user verification","example":"abc123xyz"}},"required":["accessToken"]},"UpdateUserSettingDto":{"type":"object","properties":{"secId":{"type":"number","description":"Security ID"},"annualInterestRate":{"type":"number","description":"Annual interest rate","example":0.05},"currency":{"type":"string","description":"Currency code","example":"USD"},"baseCurrency":{"type":"string","description":"Base currency code","example":"USD"},"benchmark":{"type":"string","description":"Benchmark symbol","example":"SPY"},"colorScheme":{"type":"string","description":"Color scheme","enum":["DARK","LIGHT"]},"dateRange":{"type":"string","description":"Date range filter","example":"1y"},"emergencyFund":{"type":"number","description":"Emergency fund amount","example":10000},"filters.accounts":{"description":"Account filter IDs","type":"array","items":{"type":"string"}},"filters.assetClasses":{"description":"Asset class filters","type":"array","items":{"type":"string"}},"filters.dataSource":{"type":"string","description":"Data source filter"},"filters.symbol":{"type":"string","description":"Symbol filter"},"filters.tags":{"description":"Tag filters","type":"array","items":{"type":"string"}},"isExperimentalFeatures":{"type":"boolean","description":"Enable experimental features"},"isRestrictedView":{"type":"boolean","description":"Enable restricted view mode"},"language":{"type":"string","description":"Language code","example":"en"},"locale":{"type":"string","description":"Locale code","example":"en-US"},"projectedTotalAmount":{"type":"number","description":"Projected total amount","example":1000000},"retirementDate":{"type":"string","description":"Retirement date in ISO 8601 format","example":"2050-01-01"},"savingsRate":{"type":"number","description":"Savings rate percentage","example":0.2},"viewMode":{"type":"string","description":"View mode","enum":["DEFAULT","ZEN"]}}},"FileImportDto":{"type":"object","properties":{"file":{"type":"string","format":"binary","description":"Bill file to import (CSV, PDF, OFX, etc.)","example":"alipay.csv"}},"required":["file"]},"ImportErrorDto":{"type":"object","properties":{"index":{"type":"number","description":"Index of failed transaction in the file","example":5},"error":{"type":"string","description":"Error message","example":"Transaction does not balance: -100 USD != 0"}},"required":["index","error"]},"ImportResultDto":{"type":"object","properties":{"imported":{"type":"number","description":"Number of successfully imported transactions","example":45},"failed":{"type":"number","description":"Number of failed transactions","example":2},"skipped":{"type":"number","description":"Number of skipped transactions (high confidence duplicates, auto-skipped)","example":3},"pendingReview":{"type":"number","description":"Number of transactions pending review (medium confidence duplicates)","example":2},"errors":{"description":"Array of error details for failed transactions","type":"array","items":{"$ref":"#/components/schemas/ImportErrorDto"}},"transactions":{"type":"object","description":"Array of imported transactions (optional, for debugging)"}},"required":["imported","failed","skipped","pendingReview","errors"]},"IdentifyResultDto":{"type":"object","properties":{"identified":{"type":"boolean","description":"Whether the file was successfully identified","example":true},"importerName":{"type":"string","description":"Name of the importer that can handle this file","example":"AlipayImporter"},"importerId":{"type":"string","description":"Unique identifier of the importer","example":"alipay"},"account":{"type":"string","description":"Default account used by this importer","example":"Assets:Alipay:Balance"},"message":{"type":"string","description":"Message when file cannot be identified","example":"No matching importer found"}},"required":["identified"]},"MapperDefaultsDto":{"type":"object","properties":{"sourceAccount":{"type":"string","description":"Source account for transactions (Beancount format)","example":"Assets:Alipay:Balance"},"currency":{"type":"string","description":"Default currency (ISO 4217 code)","example":"CNY"},"expenseAccount":{"type":"string","description":"Default expense account","example":"Expenses:Unknown"},"incomeAccount":{"type":"string","description":"Default income account","example":"Income:Unknown"},"accountMapping":{"type":"object","description":"Filename prefix to account mapping (for HK importers). Maps filename prefix to Beancount account path.","example":{"One":"Assets:HSBC:One","PULSE":"Liabilities:CreditCards:HSBC:Pulse"}},"useCnh":{"type":"boolean","description":"Convert CNY to CNH (offshore RMB) (for HK importers). Default: false.","example":false},"methodAccountMapping":{"type":"object","description":"Payment method to source account mapping. Maps payment method keywords to Beancount account paths. Used by Alipay/WeChat importers to determine sourceAccount based on payment method (e.g., HuaBei, CreditCard).","example":{"HuaBei":"Liabilities:Alipay:Huabei","CreditCard":"Liabilities:CreditCard"}}},"required":["sourceAccount","currency"]},"ImporterConfigDataDto":{"type":"object","properties":{"defaults":{"description":"Mapper defaults configuration","allOf":[{"$ref":"#/components/schemas/MapperDefaultsDto"}]}},"required":["defaults"]},"VersionedConfigDto":{"type":"object","properties":{"version":{"type":"string","description":"Configuration version (semver)","example":"1.0.0"},"schema":{"type":"string","description":"Configuration schema identifier","example":"importer-config-v1"},"data":{"description":"Configuration data","allOf":[{"$ref":"#/components/schemas/ImporterConfigDataDto"}]}},"required":["version","schema","data"]},"ImporterConfigDto":{"type":"object","properties":{"id":{"type":"string","description":"Configuration ID","example":"clx1234567890"},"userId":{"type":"string","description":"User ID","example":"user-abc-123"},"importerId":{"type":"string","description":"Importer identifier","example":"alipay","enum":["alipay","alipay-web","alipay-yuebao","wechat","wechat-xlsx","boc","boc-credit","ccb","cmb","cmbc","cmbc-credit","icbc","icbc-credit","hsbc-hk"]},"version":{"type":"string","description":"Configuration version (semver)","example":"1.0.0"},"schema":{"type":"string","description":"Configuration schema identifier","example":"importer-config-v1"},"config":{"description":"Configuration data (validated against Zod schema)","allOf":[{"$ref":"#/components/schemas/VersionedConfigDto"}]},"createdAt":{"format":"date-time","type":"string","description":"Creation timestamp","example":"2025-01-27T10:00:00Z"},"updatedAt":{"format":"date-time","type":"string","description":"Last update timestamp","example":"2025-01-27T10:00:00Z"}},"required":["id","userId","importerId","version","schema","config","createdAt","updatedAt"]},"ProcessNlpDto":{"type":"object","properties":{"message":{"type":"string","description":"Natural language text describing a transaction (Chinese)","example":"yesterday Starbucks spent 35 yuan","maxLength":500},"sessionId":{"type":"string","description":"Session ID for multi-turn conversation (auto-generated if not provided)","example":"session_abc123"}},"required":["message"]},"NlpTransactionInfoDto":{"type":"object","properties":{"id":{"type":"string","description":"Transaction ID"},"date":{"type":"string","description":"Transaction date (ISO format)"},"amount":{"type":"number","description":"Transaction amount"},"currency":{"type":"string","description":"Currency code"},"payee":{"type":"string","description":"Payee name"},"narration":{"type":"string","description":"Transaction narration"},"warning":{"type":"string","description":"Warning message for special transaction scenarios (e.g., cross-currency settlement)","example":"цндф║дцШУф╜┐чФиUSDш┤жцИ╖ч╗УчоЧуАВхжВщЬАшо░х╜ХCNYцФпхЗ║я╝Мшп╖хИЫх╗║ш┤зх╕Бш╜мцНвф║дцШУуАВ"}},"required":["id","date","amount","currency"]},"NlpParsedDataDto":{"type":"object","properties":{"amount":{"type":"number","description":"Extracted amount"},"currency":{"type":"string","description":"Currency code","default":"CNY"},"date":{"type":"string","description":"Transaction date (ISO format)"},"payee":{"type":"string","description":"Payee name"},"narration":{"type":"string","description":"Transaction narration"},"category":{"type":"string","description":"Category"},"incomeType":{"type":"string","description":"Income type (e.g., Salary, Bonus, Dividend, Interest)","example":"Salary"},"incomeSource":{"type":"string","description":"Income source (e.g., company name)","example":"Anthropic Inc."},"symbol":{"type":"string","description":"Security symbol code (e.g., 600519, AAPL)","example":"600519"},"quantity":{"type":"number","description":"Quantity of shares/units","example":100},"price":{"type":"number","description":"Unit price per share/unit","example":1900},"investmentAction":{"type":"string","description":"Investment action","enum":["buy","sell"],"example":"buy"},"paymentSource":{"type":"string","description":"Payment source: asset (default) or liability (credit card)","enum":["asset","liability"],"example":"asset"},"liabilityHint":{"type":"string","description":"Liability account hint (CreditCard/Huabei/Baitiao)","example":"CreditCard"},"warning":{"type":"string","description":"Warning message for special scenarios (e.g., cross-currency settlement)","example":"цндф║дцШУф╜┐чФиUSDш┤жцИ╖ч╗УчоЧуАВхжВщЬАшо░х╜ХCNYцФпхЗ║я╝Мшп╖хИЫх╗║ш┤зх╕Бш╜мцНвф║дцШУуАВ"}}},"NlpSourceTransactionDto":{"type":"object","properties":{"date":{"type":"string","description":"Transaction date (ISO format)"},"amount":{"type":"string","description":"Amount as string"},"currency":{"type":"string","description":"Currency code"},"payee":{"type":"string","description":"Payee name"},"narration":{"type":"string","description":"Transaction narration"}},"required":["date","amount","currency","narration"]},"NlpTargetTransactionDto":{"type":"object","properties":{"id":{"type":"string","description":"Existing transaction ID"},"date":{"type":"string","description":"Transaction date (ISO format)"},"amount":{"type":"string","description":"Amount as string"},"currency":{"type":"string","description":"Currency code"},"payee":{"type":"string","description":"Payee name"},"narration":{"type":"string","description":"Transaction narration"}},"required":["id","date","amount","currency","narration"]},"NlpSimilarityDto":{"type":"object","properties":{"dateMatch":{"type":"boolean","description":"Whether dates match"},"dateDiff":{"type":"number","description":"Date difference in days"},"amountMatch":{"type":"boolean","description":"Whether amounts match"},"amountDiff":{"type":"string","description":"Amount difference as decimal string"},"payeeMatch":{"type":"boolean","description":"Whether payees match"},"payeeSimilarity":{"type":"number","description":"Payee similarity score (0-1)"},"accountOverlap":{"type":"number","description":"Account overlap score (0-1)"}},"required":["dateMatch","dateDiff","amountMatch","amountDiff","payeeMatch","payeeSimilarity","accountOverlap"]},"NlpDuplicateConfirmationDataDto":{"type":"object","properties":{"confidence":{"type":"number","description":"Duplicate detection confidence score (0.5-0.89)","example":0.85},"sourceTransaction":{"description":"Source transaction summary (the new transaction being entered)","allOf":[{"$ref":"#/components/schemas/NlpSourceTransactionDto"}]},"targetTransaction":{"description":"Target transaction summary (existing potential duplicate)","allOf":[{"$ref":"#/components/schemas/NlpTargetTransactionDto"}]},"similarity":{"description":"Detailed similarity information","allOf":[{"$ref":"#/components/schemas/NlpSimilarityDto"}]},"reasons":{"description":"Human-readable reasons for duplicate detection","example":["цЧецЬЯхМ╣щЕН","щЗСщвЭхМ╣щЕН","хХЖцИ╖чЫ╕ф╝╝"],"type":"array","items":{"type":"string"}}},"required":["confidence","sourceTransaction","targetTransaction","similarity","reasons"]},"NlpRuleConfirmationDataDto":{"type":"object","properties":{"confidence":{"type":"number","description":"Rule match confidence score (0.5-0.74)","example":0.65},"matchedRule":{"type":"object","description":"Matched rule information"},"suggestedAccounts":{"type":"object","description":"Suggested accounts from the rule"},"alternatives":{"type":"array","description":"Alternative rules that also match"},"reasons":{"description":"Human-readable reasons for the match","example":["Moderate confidence (65%)","Some keywords matched (OR logic)"],"type":"array","items":{"type":"string"}}},"required":["confidence","matchedRule","suggestedAccounts","alternatives","reasons"]},"NlpAccountConfirmationDataDto":{"type":"object","properties":{"invalidAccount":{"type":"string","description":"The invalid account name","example":"Expenses:Food:Coffee"},"suggestedAccount":{"type":"string","description":"Suggested replacement account","example":"Expenses:Food:Drinks"},"similarAccounts":{"description":"Similar accounts for user selection","type":"array","items":{"type":"string"}},"errorMessage":{"type":"string","description":"Error message explaining the issue","example":"No similar account found"},"transactionContext":{"type":"object","description":"Transaction context for reference"}},"required":["invalidAccount","suggestedAccount","similarAccounts","errorMessage","transactionContext"]},"NlpSuggestedPayeeDto":{"type":"object","properties":{"id":{"type":"string","description":"Payee ID","example":"payee-123"},"name":{"type":"string","description":"Payee name","example":"Starbucks"},"category":{"type":"string","description":"Payee category","example":"food"},"source":{"type":"string","description":"Source of the payee","enum":["user","global"]},"payeeProfileId":{"type":"string","description":"PayeeProfile ID (if matched from global)","example":"profile-456"}},"required":["id","name"]},"NlpAlternativePayeeDto":{"type":"object","properties":{"id":{"type":"string","description":"Payee ID","example":"payee-alt-1"},"name":{"type":"string","description":"Payee name","example":"Starbucks Coffee"},"similarity":{"type":"number","description":"Similarity score (0-1)","example":0.75}},"required":["id","name","similarity"]},"NlpPayeeConfirmationDataDto":{"type":"object","properties":{"confidence":{"type":"number","description":"Confidence score for the payee match (0-1)","example":0.65},"originalPayee":{"type":"string","description":"Original payee string from user input","example":"цШЯх╖┤"},"suggestedPayee":{"description":"Suggested payee to use (null when no similar payees found)","nullable":true,"allOf":[{"$ref":"#/components/schemas/NlpSuggestedPayeeDto"}]},"similarity":{"type":"number","description":"Similarity score between original and suggested (0-1)","example":0.85},"alternatives":{"description":"Alternative payee options","type":"array","items":{"$ref":"#/components/schemas/NlpAlternativePayeeDto"}},"reasons":{"description":"Human-readable reasons for the match","example":["Moderate similarity (65%)","Fuzzy match on name"],"type":"array","items":{"type":"string"}}},"required":["confidence","originalPayee","similarity","alternatives","reasons"]},"RecurringMatchInfoDto":{"type":"object","properties":{"expectedId":{"type":"string","description":"Expected transaction ID"},"ruleId":{"type":"string","description":"Recurring rule ID"},"ruleName":{"type":"string","description":"Rule name for display"},"ruleIcon":{"type":"string","description":"Rule icon"},"expectedDate":{"type":"string","description":"Expected date (YYYY-MM-DD)","example":"2026-01-05"},"expectedAmount":{"type":"number","description":"Expected amount","example":3000},"confidence":{"type":"number","description":"Match confidence score (0-1)","example":0.88},"isAutoMatched":{"type":"boolean","description":"Whether auto-matched (confidence >= 0.82)"}},"required":["expectedId","ruleId","ruleName","expectedDate","expectedAmount","confidence","isAutoMatched"]},"NlpResponseDto":{"type":"object","properties":{"status":{"type":"string","description":"Response status","enum":["success","pending","error"]},"action":{"type":"string","description":"Action taken or requested","enum":["created","ask","confirm","confirm_duplicate","confirm_rule","confirm_account","confirm_payee","cancel"]},"intent":{"type":"string","description":"Transaction intent detected by EntityRouter (v6.0: 5 core intents). Frontend uses this to render scenario-specific form fields.","enum":["expense","asset","income","liability","equity"],"example":"expense"},"assetSubType":{"type":"string","description":"Asset sub-type (only present when intent is \"asset\"). Determines which asset-related form to render.","enum":["transfer","banking","investment"],"example":"investment"},"liabilitySubType":{"type":"string","description":"Liability sub-type (only present when intent is \"liability\"). borrow: borrowing money (Liabilities тЖТ Assets), repay: repaying debt (Assets тЖТ Liabilities).","enum":["borrow","repay"],"example":"borrow"},"equitySubType":{"type":"string","description":"Equity sub-type (only present when intent is \"equity\"). opening: account opening balance (Equity тЖТ Assets), adjustment: balance correction.","enum":["opening","adjustment"],"example":"opening"},"paymentSource":{"type":"string","description":"Payment source for expense transactions (v6.1). Indicates whether payment comes from asset or liability account. Only present when intent is \"expense\".","enum":["asset","liability"],"example":"liability"},"liabilityHint":{"type":"string","description":"Liability account type hint for credit card/BNPL spending (v6.1). Only present when paymentSource is \"liability\". Values: CreditCard, Huabei, Baitiao","example":"CreditCard"},"message":{"type":"string","description":"Human-readable message (for ask or error actions). Deprecated: Use messageKey for i18n support.","example":"How much did you spend?","deprecated":true},"messageKey":{"type":"string","description":"i18n message key for frontend translation. Use this instead of message for internationalization support.","example":"nlp.slot.prompt"},"messageParams":{"type":"object","description":"Parameters for message interpolation. Used with messageKey for dynamic values in translated messages.","example":{"slot":"amount","name":"Starbucks","similarity":85}},"sessionId":{"type":"string","description":"Session ID for multi-turn dialogue. Must be included in subsequent requests to continue the conversation.","example":"session_abc123"},"waitingFor":{"type":"string","description":"Which slot is waiting for user input","example":"amount"},"transaction":{"description":"Created transaction info (for created action)","allOf":[{"$ref":"#/components/schemas/NlpTransactionInfoDto"}]},"parsedData":{"description":"Parsed data for confirmation (when action is \"confirm\"). Contains extracted fields that user should verify before transaction creation.","allOf":[{"$ref":"#/components/schemas/NlpParsedDataDto"}]},"duplicateData":{"description":"Duplicate detection data (when action is \"confirm_duplicate\"). Contains information about potential duplicate transaction for user confirmation.","allOf":[{"$ref":"#/components/schemas/NlpDuplicateConfirmationDataDto"}]},"ruleData":{"description":"Rule match data (when action is \"confirm_rule\"). Contains information about medium-confidence rule match for user confirmation.","allOf":[{"$ref":"#/components/schemas/NlpRuleConfirmationDataDto"}]},"accountData":{"description":"Account validation data (when action is \"confirm_account\"). Contains information about invalid account for user correction.","allOf":[{"$ref":"#/components/schemas/NlpAccountConfirmationDataDto"}]},"payeeData":{"description":"Payee confirmation data (when action is \"confirm_payee\"). Contains information about medium/low confidence payee match for user confirmation.","allOf":[{"$ref":"#/components/schemas/NlpPayeeConfirmationDataDto"}]},"confidence":{"type":"number","description":"Overall confidence score (0-1)","example":0.85},"confidenceThreshold":{"type":"number","description":"Confidence threshold for automatic creation (default: 0.75). When confidence < threshold, action will be \"confirm\" requiring user verification.","example":0.75},"recurringMatch":{"description":"Recurring transaction match info (when action is \"created\"). Contains match details when transaction matches a pending expected transaction.","allOf":[{"$ref":"#/components/schemas/RecurringMatchInfoDto"}]},"recurringSuggestion":{"description":"Recurring rule creation suggestion (when action is \"created\"). Contains suggestion to create a recurring rule based on detected patterns. Only present when no existing rule matched and similar historical transactions were found.","allOf":[{"$ref":"#/components/schemas/RecurringSuggestionDto"}]}},"required":["status","action"]},"NetWorthResponseDto":{"type":"object","properties":{"netWorth":{"type":"string","description":"Total net worth (assets - liabilities)","example":"500000.00"},"assets":{"type":"string","description":"Total assets value","example":"600000.00"},"liabilities":{"type":"string","description":"Total liabilities value (positive number)","example":"100000.00"},"monthlyReturn":{"type":"string","description":"Monthly return (change from last month)","example":"15000.00"},"monthlyReturnPercentage":{"type":"string","description":"Monthly return percentage","example":"3.15"},"currency":{"type":"string","description":"Currency code","example":"CNY"},"asOf":{"type":"string","description":"Data as of date (ISO 8601)","example":"2024-06-15T00:00:00.000Z"}},"required":["netWorth","assets","liabilities","monthlyReturn","monthlyReturnPercentage","currency","asOf"]},"AccountItemDto":{"type":"object","properties":{"id":{"type":"string","description":"Account ID"},"name":{"type":"string","description":"Full account name","example":"Assets:Bank:CMB:Savings"},"displayName":{"type":"string","description":"Display name (last part of account path)","example":"Savings"},"balance":{"type":"string","description":"Account balance","example":"50000.00"},"currency":{"type":"string","description":"Currency code","example":"CNY"}},"required":["id","name","displayName","balance","currency"]},"PlatformGroupDto":{"type":"object","properties":{"platformId":{"type":"string","description":"Platform ID"},"platformName":{"type":"string","description":"Platform display name","example":"CMB Bank"},"accounts":{"description":"Accounts within this platform","type":"array","items":{"$ref":"#/components/schemas/AccountItemDto"}},"totalBalance":{"type":"string","description":"Total balance across all accounts in platform","example":"100000.00"}},"required":["platformId","platformName","accounts","totalBalance"]},"AccountsSummaryDto":{"type":"object","properties":{"totalAccounts":{"type":"number","description":"Total number of accounts"},"totalPlatforms":{"type":"number","description":"Total number of platforms"}},"required":["totalAccounts","totalPlatforms"]},"AccountsResponseDto":{"type":"object","properties":{"groups":{"description":"Account groups by platform","type":"array","items":{"$ref":"#/components/schemas/PlatformGroupDto"}},"summary":{"description":"Summary statistics","allOf":[{"$ref":"#/components/schemas/AccountsSummaryDto"}]}},"required":["groups","summary"]},"CashFlowResponseDto":{"type":"object","properties":{"period":{"type":"string","description":"Period identifier (YYYY-MM)","example":"2024-06"},"income":{"type":"string","description":"Total income for the period","example":"25000.00"},"expense":{"type":"string","description":"Total expenses for the period","example":"18000.00"},"netSavings":{"type":"string","description":"Net savings (income - expense)","example":"7000.00"},"savingsRate":{"type":"string","description":"Savings rate percentage (netSavings / income * 100)","example":"28.00"},"currency":{"type":"string","description":"Currency code","example":"CNY"}},"required":["period","income","expense","netSavings","savingsRate","currency"]},"TimeSeriesPointDto":{"type":"object","properties":{"date":{"type":"string","description":"Date in YYYY-MM-DD format","example":"2024-06-15"},"value":{"type":"string","description":"Value at this date","example":"500000.00"},"change":{"type":"object","description":"Change from previous point","example":"5000.00"}},"required":["date","value"]},"TrendSummaryDto":{"type":"object","properties":{"startValue":{"type":"string","description":"Value at start of period","example":"450000.00"},"endValue":{"type":"string","description":"Value at end of period","example":"500000.00"},"totalChange":{"type":"string","description":"Total change over period","example":"50000.00"},"totalChangePercentage":{"type":"string","description":"Total change percentage","example":"+11.11%"}},"required":["startValue","endValue","totalChange","totalChangePercentage"]},"PortfolioTrendsResponseDto":{"type":"object","properties":{"series":{"description":"Time series data points","type":"array","items":{"$ref":"#/components/schemas/TimeSeriesPointDto"}},"summary":{"description":"Period summary","allOf":[{"$ref":"#/components/schemas/TrendSummaryDto"}]},"period":{"type":"string","description":"Period requested","example":"6m"},"granularity":{"type":"string","description":"Data granularity","example":"month"},"currency":{"type":"string","description":"Currency","example":"CNY"}},"required":["series","summary","period","granularity","currency"]},"AnonymousLoginDto":{"type":"object","properties":{"accessToken":{"type":"string","description":"Access token for anonymous login"}},"required":["accessToken"]},"InternetIdentityLoginDto":{"type":"object","properties":{"principalId":{"type":"string","description":"Internet Identity principal ID"}},"required":["principalId"]},"VerifyAttestationDto":{"type":"object","properties":{"deviceName":{"type":"string","description":"Device name for identification"},"credential":{"type":"object","description":"WebAuthn attestation credential"}},"required":["deviceName","credential"]},"GenerateAssertionOptionsDto":{"type":"object","properties":{"deviceId":{"type":"string","description":"Authentication device ID"}},"required":["deviceId"]},"VerifyAssertionDto":{"type":"object","properties":{"deviceId":{"type":"string","description":"Authentication device ID"},"credential":{"type":"object","description":"WebAuthn assertion credential"}},"required":["deviceId","credential"]}}}}